<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Theory</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Theory</h1>
</header>
<h1 id="sec:ThePhysics">The physics</h1>
<p>In this section, I explain the theoretical framework necessary for
understanding and implementing our numerical simulations.</p>
<h2 id="SEC:potential-density-pairs">Potential-Density Pairs</h2>
<p>It is intriguing to draw a comparison between ’stellar dynamics’ and
’celestial dynamics.’ In essence, this involves contrasting the motion
of stars within a galaxy with the motion of celestial bodies within our
solar system. In the solar system, the gravitational field is known to
high precision. Typically, one starts by considering the Sun and then
introduces additional complexities as required by the specific problem
at hand. For instance, if the goal is to send the James Webb Space
Telescope into orbit around the Sun-Earth <span
class="math inline">\(L_1\)</span> Lagrange point, a first-order
computation does not necessitate the inclusion of all other planets in
the system. Similarly, if the aim is to investigate the long-term
evolution of comet orbits, one considers the effects of the Sun and
Jupiter on the orbit of the comet, perhaps Saturn as well. In essence,
the approach entails identifying the most influential bodies in the
system and then applying principles derived from the restricted three-
or four-body problem.</p>
<p>In the realm of galactic dynamics, the paradigm differs
significantly. To begin with, we are dealing with an immense number of
stars—billions, to be precise. However, when considering the orbits of
bodies within the Galaxy, we need not account for direct star-star
interactions. A compelling rationale for this can be found in Chapter
1.2.1 of <span class="citation" data-cites="2008gady.book.....B">Binney
and Tremaine (2008)</span>, where the authors demonstrate that direct
stellar encounters are exceedingly rare, with their cumulative effects
on significantly changing a star’s momentum being substantial only after
a staggering timescale of 10<span class="math inline">\(^{16}\)</span>
years—a duration far surpassing the age of the universe.</p>
<p>As a result, our focus shifts from individual stars to the continuous
density distribution of stars throughout the Galaxy. Consequently, the
paradigm in galactic dynamics revolves around employing observational
evidence to constrain the mass adistribution, ultimately leading to the
determination and validation of the gravitational field. This process
hinges on arguably one of the most pivotal equations in dynamics, known
as Poisson’s equation:</p>
<p><span class="math display">\[\nabla^2 \Phi = 4\pi G
\rho.\]</span></p>
<p>To present this equation in a more intuitive fashion, we can shift
our focus from examining the Laplacian of the potential to analyzing the
divergence of the gravitational field. This is feasible because the
gravitational field is ’conservative,’ signifying that it arises from
the gradient of a scalar-valued function, which is the gravitational
potential. In other words, we can express this relationship as: <span
class="math inline">\(\nabla \Phi = - \vec{g}\)</span>. The negative
sign signifies that the gravitational force doesn’t act in the direction
of the steepest ascent, but rather in the direction of descent.
Consequently, through this substitution, Poisson’s equation can be
reformulated as: <span class="math display">\[\nabla \cdot \vec {g} =
-4\pi G \rho,\]</span> This equation provides a captivating physical
insight: if we visualize a gravitational field as a fluid, a mass
behaves like a ’sink.’ As the density increases, the rate at which this
’matter-fluid’ flows toward the mass also intensifies. Moving forward,
it’s valuable to approach Poisson’s equation in integral form, which
aids in determining the mass distribution of the gravitational field.
This is achieved by initially integrating over a volume and subsequently
applying the divergence theorem. The theorem allows us to transition
from evaluating the divergence of the gravitational field within a
volume to instead considering the flux passing through a surface.</p>
<p>Simultaneously, by performing a volume integral over the density, we
can derive the mass profile. The key challenge lies in selecting
appropriate integration limits to ensure that the gravitational field
and the normal vectors of the chosen surface are consistently parallel.
Consequently, the right-hand side of the equation is often treated as:
<span class="math display">\[\int \left(\nabla \cdot \vec{g} \right) dV
= \oint \vec{g} \cdot d\vec{S} = g SA.\]</span> Simultaneously, the
right hand-side is treated as: <span class="math display">\[4\pi G \int
\rho dV = 4\pi G M_{\textrm{enc}},\]</span> where <span
class="math inline">\(M_{\textrm{enc}}\)</span> is the mass enclosed
within the same surface. In the end, these two quantities can be
related: <span
class="math display">\[\label{EQ:force_from_enclosed_mass}
    \vec{g} = \frac{4\pi G M_{\textrm{enc}}}{SA} \hat{n},\]</span> where
the unit vector is re-introduced given the symmetry chosen symmetry of
the problem. This quickly gives rise to the familiar Keplerian case,
when the mass enclosed is a point mass and the equi-potential surface is
a sphere, i.e. <span class="math inline">\(SA=4\pi r^2\)</span>, and we
will have re-derived Newton’s law of gravitation: <span
class="math inline">\(\vec{g} = \frac{G M}{r^2} \hat{r}\)</span>.</p>
<p>A series of exercises can subsequently be undertaken. If a high
degree of symmetry is present, and a chosen density distribution is
given, one can straightforwardly determine the gravitational field. Some
basic exercises include finding the gravitational field of: a point
mass, a uniform sphere, a sphere with increasing mass, an infinitely
large sheet, and so on. The reverse approach is also possible, in which
one first selects the form of the potential and then applies the
Laplacian to deduce the density distribution. An example, and a
potential that I employ in my thesis, is the Plummer distribution:</p>
<p><span class="math display">\[\Phi(r|M,b) = \frac{GM}{\sqrt{r^2 +
b^2}}.\]</span> This can be understood as a point mass that has been
smeared by some characteristic length, <span
class="math inline">\(b\)</span>. There exists another famous model
which applies the same softening principle, the Hernquist: <span
class="math inline">\(\Phi(r) = \frac{GM}{r + b}\)</span> <span
class="citation" data-cites="1990ApJ...356..359H">(Hernquist
1990)</span>. Additionally one can move to distributions with
cylindrical symmetry, an example of a model I employ in my thesis is the
Myamoto-Nagai <span class="citation"
data-cites="1975PASJ...27..533M">(Miyamoto and Nagai 1975)</span>: <span
class="math display">\[\Phi\left(R,z|M,a,b\right) = \frac{GM}{\sqrt{R^2
+ \left(\sqrt{z^2 + b^2} + a\right)^2}},\]</span> where <span
class="math inline">\(a\)</span> is the characteristic disc length, and
<span class="math inline">\(b\)</span> is the characteristic disc
height. Interestingly, if <span class="math inline">\(a\)</span> is set
to zero, a Plummer distribution is recovered. Another important model
that I will present here is the Allan-Santillian Halo model. But first,
there is an important concept to introduce that is often used as a
diagnostic tool for galaxies, known as the ’rotation curve.’ In essence,
we can measure the net rotation of a galaxy by determining the
rotational speed of its constituent stars. A body in a circular orbit
has all of its kinetic energy in rotational velocity, and thus the
centripetal force counterbalances gravity when <span
class="math inline">\(\frac{v_c^2}{r} = g\)</span>. We can use EQ. <a
href="#EQ:force_from_enclosed_mass" data-reference-type="ref"
data-reference="EQ:force_from_enclosed_mass">[EQ:force_from_enclosed_mass]</a>
to relate the circular velocity to the enclosed mass, as in the case of
spherical symmetry, as: <span class="math display">\[v_c = \sqrt{\frac{G
M_{\textrm{enc}}}{r}}.\]</span> Considering this relationship, and the
empirical observation that many external galaxies exhibit nearly
constant rotation curves at greater distances, <span class="citation"
data-cites="1986RMxAA..13..137A">C. Allen and Martos (1986)</span>
proposed a halo potential characterized by mass increasing linearly with
distance, resulting in a consistent rotational speed. This concept can
be mathematically expressed through the following power law: <span
class="math display">\[M_{\textrm{enc}}\left(r|M_0,\beta,\gamma\right) =
\frac{M_{0}\left(r/\beta\right)^{\gamma}}{\left(1+\left(r/\beta\right)\right)^{\gamma-1}}.\]</span>
In this formulation, the mass diverges, rendering the model
non-physical. Therefore, <span class="math inline">\(M_0\)</span>
doesn’t represent the total mass but rather serves as a parameter
defining the rate at which mass accumulates with increasing distance. On
the other hand, <span class="math inline">\(\beta\)</span> denotes a
scale length parameter, indicating distances under which mass
accumulation is minimal. This potential is referred to as a ‘halo’
potential because it aims to simulate the presence of the dark matter
halo enveloping the Galaxy. It’s worth noting that, in practice, halos
contribute less to the interior of galaxies when compared to visible
matter. Another essential consideration is determining the radius at
which to truncate the halo. In our article, we adhered to the convention
proposed in earlier studies, choosing to truncate it at 100 kpc. This
yields the following potential: <span
class="math display">\[\Phi\left(r|M_t,\gamma,\beta,r_\mathrm{c}\right)
= -\frac{GM_t}{r} -
\frac{GM_t}{\left(\gamma-1\right)\beta}\left.\left[\frac{\left(\gamma-1\right)}{1+\left(r&#39;/\beta\right)^{\gamma-1}}
-
\ln\left(1+\left(r&#39;/\beta\right)^{\gamma-1}\right)\right]\right|_{r_c}^{r},\]</span>
where <span class="math inline">\(r_0\)</span> is the truncation radius,
<span class="math inline">\(\gamma\)</span> is the power parameter whose
best fit value was found to be 2.02, and <span
class="math inline">\(M_t\)</span> is the total mass. These values for
all of the can be found in Table 1 of <span class="citation"
data-cites="2023A&amp;A...673A..44F">Ferrone et al. (2023)</span>.</p>
<h3 class="unnumbered" id="the-laplacian-is-a-linear-operator">The
Laplacian is a linear operator</h3>
<p>It is important to note that the Laplacian is a linear operator, i.e.
<span class="math inline">\(\nabla^2\left(a_0\Phi_0 + a_1\Phi_1\right) =
a_0\nabla^2\Phi_0 + a_1\nabla^2 \Phi_1\)</span>. Likewise, the right
hand-side of Poisson’s equation is multiplication, which is a linear.
Therefore both the total potential and the total density of a system can
be described as a sum of simpler parts:</p>
<p><span class="math display">\[\nabla^2 \left(\Phi_0 + \Phi_1 + \dots +
\Phi_N \right) = 4\pi G \left(\rho_0 + \rho_1 + \dots + \rho_N
\right).\]</span> This is fundamental when creating models and allows us
to dissect the Milky Way into parts based on different pieces of
observational motivation. This is what is done by many Galactic
potential models: <span class="citation"
data-cites="1991RMxAA..22..255A">Christine Allen and Santillan
(1991)</span>, <span class="citation"
data-cites="2017MNRAS.465...76M">(McMillan 2017)</span>, and lastly, the
potential model that we employ this this work, <span class="citation"
data-cites="2017A&amp;A...598A..66P">Pouliasis, Di Matteo, and Haywood
(2017)</span>. This paper presents two models and compares them the
older model of <span class="citation"
data-cites="1991RMxAA..22..255A">Christine Allen and Santillan
(1991)</span>. One of the models consists of a small central bugle
described by a Plummer, two Miyamoto-Nagai disks, and a Allen-Santillian
halo. The second model consits of two discs and the dark matter halo
only.</p>
<h2 id="sec:DistributionFunctionSampling">Distribution Function
Sampling</h2>
<p>In this thesis, my objective is to simulate the integration of
star-particles’ orbits within Galactic globular clusters and observe
their escape, forming tidal tails. A crucial aspect is the accurate
establishment of initial conditions for these star-particles. To achieve
this, I have drawn inspiration from chapter 4 of <span class="citation"
data-cites="2008gady.book.....B">Binney and Tremaine (2008)</span>,
which have informed this section. To begin, the distribution of stars
within the system of interest is described by a six-dimensional
distribution function over the phase space variables, denoted as <span
class="math inline">\(f\left(\vec{x},\vec{v}\right)\)</span>. Given that
this is a distribution function, it is inherently normalized.
Consequently, when integrated over the phase space variables, the result
is equal to 1: <span class="math inline">\(\mathcal{P}=\int
f\left(\vec{x},\vec{v}\right) d^3\vec{x}d^3\vec{v}=1.\)</span> Another
assumption that is made in DF modeling is that the phase-space volume is
constant. i.e. <span class="math inline">\(\frac{d f}{dt}=0\)</span>. By
applying the derivative and chain rule, we obtain: <span
class="math display">\[\frac{df}{dt} = \frac{\partial f}{\partial t} +
\frac{\partial f}{\partial
\vec{x}}\cdot\frac{d\vec{x}}{dt}+\frac{\partial f}{\partial
\vec{v}}\cdot\frac{d\vec{v}}{dt} = 0.\]</span> In practice, this
equation is stating that stars are not being created or destroyed, which
is not strictly true but satisfactory for our purposes. For instance,
stars in globular clusters are very light and not massive enough to go
super nova. Additionally, stars within globular clusters are old, and
gas-less thus are not creating stars.</p>
<p>Next, this equation is manipulated for various physical
configurations, i.e. if this mass distribution is spherical, or if the
velocity of the stars are <em>isotropic</em> (equally random in all
directions), or if there is anisotropy, i.e. a correlation between the
velocities of stars. In my thesis thus far, I have analyzed one of the
simplest cases, an Isotropic Plummer distribution. To do this, I have
taken the result that the distribution function depends only on the
energy as: <span class="math display">\[\label{EQ:plummerDF}
    f\left(E\right)\propto E^{-7/2},\]</span> Here, the energy, denoted
as <span class="math inline">\(E\)</span>, combines the kinetic and
potential energies, and it is expressed as: <span
class="math inline">\(E=\frac{1}{2}v^2 + \frac{GM}{\sqrt{r^2 +
b^2}}\)</span>. Armed with this knowledge, we can formulate a set of
initial conditions for a globular cluster, taking into account its
specific mass and characteristic radius.</p>
<h3 class="unnumbered" id="inverse-transform-sampling">Inverse Transform
Sampling</h3>
<p>Inverse transform sampling is a highly practical technique for
generating a set of discrete realizations from any probability density
function. In theory, it operates as follows: Let <span
class="math inline">\(\mathcal{F}\)</span> be the cumulative
distribution function (CDF) of a given probability density function,
denoted as <span class="math inline">\(f\)</span>: <span
class="math display">\[\mathcal{F}\left(x\right) = \int_{-\infty}^{x}
f\left(x&#39;\right)dx&#39;.\]</span> The probability of drawing any
number <span class="math inline">\(x\)</span>, to be less than <span
class="math inline">\(x_0\)</span>, is the value of the CDF at <span
class="math inline">\(x\)</span>: <span
class="math display">\[\mathcal{P}\left(x &lt; x_0\right) =
\mathcal{F}\left(x\right).\]</span> Since CDFs are monotonically
increasing and one-to-one with the independent variable, we can
substitute: <span class="math display">\[\mathcal{P}(F(x)&lt;F(x_0)) =
\mathcal{P}(x&lt;x_0).\]</span> Now we may introduce a random variable
<span class="math inline">\(Y\)</span>, whose value is equally probably
between [0,1], which is described by a DF of: <span
class="math display">\[f(y) = \begin{cases} 1 &amp; \text{if } y \in
[0,1] \\ 0 &amp; \text{otherwise} \end{cases}\]</span> We can
substitute, stating that the probability of drawing a uniform random
value between [0,1] is the same probability of drawing a value <span
class="math inline">\(x\)</span> as being less than the value of
interest: <span class="math inline">\(x_0\)</span>. <span
class="math display">\[\mathcal{P}\left(Y&lt;\mathcal{F}(x_0)\right) =
\mathcal{P}(x&lt;x_0).\]</span> Again, since the CDF and <span
class="math inline">\(x\)</span> are monotonically related and
one-to-one, we can apply the inverse transform to the left hand side:
<span
class="math display">\[\mathcal{P}\left(\mathcal{F}^{-1}(Y)&lt;x_0\right)
= \mathcal{P}(x&lt;x_0),\]</span> which in turn leads to the desired
result that: <span class="math display">\[\mathcal{F}^{-1}\left(Y\right)
= x.\]</span> In practice, you can visualize this equation as follows:
imagine plotting any CDF against the independent variable, and then
randomly drawing horizontal lines with heights between [0,1] from
negative infinity. Observe where these lines intersect the CDF, which
determines the corresponding <span class="math inline">\(x\)</span>
values.</p>
<p>For instance, consider the Plummer sphere. We wish to sample this
distribution to find a set of initial conditions for <span
class="math inline">\(N\)</span> particles. The CDF of the normalized
mass distribution is as shown in Fig. <a
href="#fig:inverse-transform-sampling" data-reference-type="ref"
data-reference="fig:inverse-transform-sampling">1</a>. The fraction of
the total enclosed mass, denoted as <span
class="math inline">\(M_X\)</span> as a function of distance scaled to
the characteristic length, <span class="math inline">\(r_X =
r/b\)</span>, is: <span class="math display">\[M_X =
\frac{r_X^3}{\left(1+r_X^2 \right)^{3/2}}.\]</span> The plot shown in
Fig. <a href="#fig:inverse-transform-sampling" data-reference-type="ref"
data-reference="fig:inverse-transform-sampling">1</a> has a scale radius
of 10.</p>
<figure>
<img src="images/inverse-transform-sampling.png"
id="fig:inverse-transform-sampling"
alt="An example of inverse transform sampling. The CDF shown in the top panel is the enclosed mass of a Plummer sphere, normalized by its total mass. The horizontal blue lines are sampled from a uniform distribution, using the function np.random.rand() from Python’s library numpy, and are traced to intersect the CDF. " />
<figcaption aria-hidden="true">An example of inverse transform sampling.
The CDF shown in the top panel is the enclosed mass of a Plummer sphere,
normalized by its total mass. The horizontal blue lines are sampled from
a uniform distribution, using the function <code>np.random.rand()</code>
from Python’s library <code>numpy</code>, and are traced to intersect
the CDF. </figcaption>
</figure>
<p>Applying inverse transform sampling to this mass distribution
provides the radial distances from the center of the system. Next, we
need to find the angular positions on the unit sphere. One may naively
attempt to uniformly sample the polar and azimuthal angles, <span
class="math inline">\(\theta,\phi\)</span>, however this would
incorrectly bunch up points at the poles. One must instead consider a DF
in which sampling equally probable in all areas. The argument is as
follow, first: <span class="math inline">\(\int f dA&#39; = 1\)</span>
where we are integrating over a unit sphere. We know that <span
class="math inline">\(\int dA = 4\pi\)</span>, thus, <span
class="math inline">\(f dA&#39; = (1/4\pi) dA\)</span>. Note that <span
class="math inline">\(dA&#39;\)</span> does not equal <span
class="math inline">\(dA\)</span>. Next, on a sphere the infinitesimal
surface area is <span class="math inline">\(dA = \sin(\theta)d\theta
d\phi\)</span>. We can now related this to the DF, <span
class="math inline">\(f=(1/4\pi)\sin(\theta)\)</span> and <span
class="math inline">\(dA&#39; =d\theta d\phi\)</span>. This DF is used
to find the CDF, which is then used to randomly sample the angles.
Notice that it does not depend on <span
class="math inline">\(\phi\)</span>, which is thus sampled from a
uniform DF, which is a linear CDF that ranges [0,1] and runs over
[0,<span class="math inline">\(2\pi\)</span>].</p>
<p>Lastly, sampling the velocities is not independent from the from the
position, so we must consider the conditional DF: <span
class="math inline">\(f(v|r)\)</span> from Eq. <a href="#EQ:plummerDF"
data-reference-type="ref"
data-reference="EQ:plummerDF">[EQ:plummerDF]</a>. The number density of
particles at a point, <span class="math inline">\(\vec{x}\)</span>, is
found by integrating the velocities, i.e. <span
class="math inline">\(N(\vec{x})=\int
f(\vec{v}|\vec{x})d^3\vec{v}\)</span>. Note that another way of writing
a probability density function, is <span
class="math inline">\(f&#39;=\frac{dN}{dv}\)</span>. Also note that
because we are assuming the velocities are equally random in all
directions, we may find <span
class="math inline">\(\frac{dN}{dv}\)</span> by integrating then total
DF and then differentiate with respect to <span
class="math inline">\(v\)</span>:</p>
<p><span class="math display">\[\frac{dN}{dv} = \frac{d}{dv}\int
f(\vec{v}|\vec{x}) (v\sin\theta&#39;d\phi&#39;)(vd\theta&#39;)(dv) =
4\pi v^2 f(v|\vec{x}),\]</span> which gives the number density per
particle speed. Note that the angles here are not in physical space but
rather velocity space. Lastly, to construct the CDF of this DF, we must
know what the proper limits are. The speeds available to this particle
range from zero to the escape speed, which is <span
class="math inline">\(v_{esc}=\sqrt{2\Phi(r)}\)</span>. Thus, the CDF
is: <span class="math display">\[\label{EQ:CDF-velocities}
    CDF(v) = C \int_0^{v&lt;v_{esc}} 4\pi v^2 f(v|\vec{x}) dv,\]</span>
where <span class="math inline">\(C\)</span> is a normalization
constant. In practice, we ignore this constant because for each particle
position, we find the non-normalized CDF and then divide by the final
value to normalize it. This process is visualized in Fig. <a
href="#fig:cdf-velocities" data-reference-type="ref"
data-reference="fig:cdf-velocities">2</a>. Once the speeds are found,
the orientations of the velocity vectors can by found by randomly
sampling x,y,z values from uniform random distributions between [-1,1]
and then re-normalizing the resultant vector and multiplying it by the
final speed.</p>
<figure>
<img src="images/cdf-velocities.png" id="fig:cdf-velocities"
alt="An example of inverse transform sampling of the initial velocities. Each CDF is created per particle, since we are sampling the velocities given an initial position. The CDF’s have the functional forms specified by Eqs. [EQ:plummerDF] and [EQ:CDF-velocities]." />
<figcaption aria-hidden="true">An example of inverse transform sampling
of the initial velocities. Each CDF is created per particle, since we
are sampling the velocities given an initial position. The CDF’s have
the functional forms specified by Eqs. <a href="#EQ:plummerDF"
data-reference-type="ref"
data-reference="EQ:plummerDF">[EQ:plummerDF]</a> and <a
href="#EQ:CDF-velocities" data-reference-type="ref"
data-reference="EQ:CDF-velocities">[EQ:CDF-velocities]</a>.</figcaption>
</figure>
<h2 id="tidal-forces-and-the-restricted-three-body-problem">Tidal Forces
and the Restricted Three Body Problem</h2>
<p>With the potential-density pairs discussed in section <a
href="#SEC:potential-density-pairs" data-reference-type="ref"
data-reference="SEC:potential-density-pairs">1.1</a> and a method in
place for generating initial positions within a sphere of
star-particles, the stage is set to address a fundamental question:
<em>What causes stars to escape from globular clusters?</em></p>
<h3 class="unnumbered" id="tidal-forces">Tidal Forces</h3>
<p>As any good physicist would do, we will first solve a simpler problem
and draw insights from it while considering the more complex problem at
hand. Instead of considering the Galaxy exerting a force on a globular
cluster, consider the gravitational force from a point mass acting on
three points along a line: <span class="math inline">\(r-\delta
r\)</span>, <span class="math inline">\(r\)</span>, <span
class="math inline">\(r+\delta r\)</span>, where <span
class="math inline">\(\delta r&lt;&lt; r\)</span>. We can perform a
Taylor expansion to approximate the force to second order at the
interior and exterior points. <span
class="math display">\[F_{inside}=-\frac{GMm}{\left(r-\delta r\right)^2}
\sim -\frac{GMm}{r^2}\left[1+\frac{2\delta r}{r}\right]\]</span></p>
<p><span class="math display">\[F_{outside}=-\frac{GMm}{\left(r+\delta
r\right)^2} \sim -\frac{GMm}{r^2}\left[1-\frac{2\delta
r}{r}\right]\]</span> When describing these forces relative to the
center of mass of the body located at <span
class="math inline">\(r\)</span>, we subtract the force vector upon the
center and see that the opposite sides of the body are being ripped away
from the center with a force:</p>
<p><span class="math display">\[F_{\mathrm{tidal}}\sim 2GMm \frac{\delta
r}{r^3}.\]</span> By positioning an extended body in a gravitational
field where the gravitational pull is stronger closer to the center than
at a greater distance, it results in tidal forces. It’s worth noting the
functional form of the tidal force originating from the center of mass
of the object: this force increases linearly with distance from the
center of the object. Additionally, it follows an inverse-cubed
relationship between the distance to the host, making it considerably
weaker than the gravitational force.</p>
<p>This is a suitable qualitative comparison. Even though the galactic
gravitational field is not Keplerian, as in the previous example, it’s
well-established that the gravitational field still exhibits a gradient
and is more pronounced toward the center. Furthermore, globular clusters
are inherently extended, spherical bodies. Therefore, based on the
previous example, we anticipate that globular clusters will undergo
deformation along the radial direction, with those farther from the
center cluster experiencing more significant deformation than those
situated farther away.</p>
<h3 class="unnumbered"
id="the-circular-restricted-planar-three-body-problem">The circular
restricted-planar three body problem</h3>
<p>Another simpler system to draw parallels with, as we aim to establish
a theoretical conceptual framework, is the restricted three-body
problem. In this scenario, we analyze two masses that mutually affect
each other and a third particle that doesn’t exert any gravitational
force but is influenced by the other two bodies. A well-known instance
of this is the Sun-Earth-Spacecraft setup. While the theory for this
section will be further elaborated in the thesis, my objective here is
to offer a broad overview of the mechanics.</p>
<p>In essence, when examining the restricted three-body problem, we
further simplify this scenario. Initially, we assume that the two larger
bodies are in circular orbits around the center of mass. This enables us
to establish a non-inertial reference frame that rotates at a constant
angular velocity, matching that of the two larger bodies. Subsequently,
we analyze the situation in which the third particle orbits within the
same plane as the two massive bodies. Despite these simplifications, we
can derive potent physical tools for comprehending tidal phenomena.
Firstly, we begin by formulating the Lagrangian of the third particle:
<span class="math display">\[\mathcal{L}_{\mathrm{inertial frame}} =
T(\dot{x},\dot{y},\dot{z}=0)-U(x,y,z=0,t)\]</span> When we analyze the
problem within an inertial frame, the potential energy is time-dependent
motion since the larger two bodies are in motion with respect to the
reference frame, leading to increased complexities. Consequently, we
transition to a non-inertial reference frame, rotating at the same
angular velocity as the two massive bodies. Given our simplification of
the problem to circular orbits, the massive bodies remain fixed at
points along the x-axis. While this approach eliminates the time
dependence of the potential energy, it introduces a spatial dependence
to the kinetic energy: <span
class="math display">\[\mathcal{L}_{\mathrm{rotating frame}} =
T(x,y,z=0,\dot{x},\dot{y},\dot{z})-U(x,y,z=0)\]</span> Recall the
two-body problem, where we introduced polar coordinates and observed
that the kinetic energy also depends on the spatial coordinate,
expressed as <span class="math inline">\((1/2)m\left(\dot{R}^2
+(R\omega)^2 \right)\)</span>. To delve deeper into the problem, we
shifted this spatial dependence to the potential energy, giving rise to
an <em>effective</em> potential energy. The same approach is applied to
the three-body problem. In this case, we seek locations where the
effective potential exhibits critical points. The critical points of the
effective potential in the three-body problem are referred to as the
<em>Lagrange points</em>.</p>
<p>Much like the two-body problem, the three-body problem exhibits
distinct categories of orbits based on the total energy. When the total
energy is positive, bodies follow hyperbolic orbits; zero energy results
in parabolic orbits; negative energy leads to bounded eccentric orbits,
and the minimum energy corresponds to circular orbits. Just as in the
two-body problem, the three-body problem can be subdivided into
different “realms” of possible orbits based on the total energy.</p>
<p>In one of these realms, a particle is initially bound to the less
massive secondary. It can transition to having its dynamics dominated by
the primary body if it possesses a certain level of energy. This
transition from being influenced by the secondary to the primary occurs
at the <em>first Lagrange point</em>. To locate this point, one sets the
effective potential equal to zero for a particle along the x-axis in the
rotating frame. Remarkably, determining the position of the Lagrange
point involves solving a quintic polynomial for which no exact analytic
solution exists. Consequently, the location of the Lagrange point is
always reported as an approximation.</p>
<p>Another intriguing concept that arises from this analysis is the
<em>Hill</em> sphere, which can be defined as the sphere encompassing
the secondary body within which its gravitational force prevails in
influencing the motion of a test particle. Mathematically, this sphere
can be expressed as: <span class="math display">\[r_h =
a\left(\frac{m_1}{3\left(m_0+m_1\right)}\right)^{1/3},\]</span> where
<span class="math inline">\(a\)</span> is the semi-major axis of the
orbit between the two bodies, and there masses are <span
class="math inline">\(m_0\)</span> and <span
class="math inline">\(m_1\)</span>.</p>
<h2 id="phase-mixing">Phase-Mixing</h2>
<p>Another important concept that will serve to interpret the results is
<em>phase-mixing</em>.<a href="#fn1" class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a> Phase-mixing occurs when we an
initial distribution of points in phase-space about some location, <span
class="math inline">\(r,v\)</span> with some spread or
<em>dispersion</em>, <span class="math inline">\(\delta r,
\sigma_{v}\)</span>, naturally spread over time and eventually uniformly
distribute themselves over all possible configurations allowed by the
system. A good way to estimate the time scale over which this occurs is
to look at the maximum difference in frequencies between two particles
complete phase space orbits:</p>
<p><span class="math display">\[\tau_{\textrm{phase-mixing}} =
\frac{2\pi}{\Delta f}.\]</span> Again, to gain physical insight, we can
look to the Kerplerian case for some quick estimates. From Kepler’s
third law, we know the relationship between orbit period and the
semi-major axis of an orbit: <span
class="math inline">\(T_{\textrm{dyn}}^2\propto a^3\)</span>. We can
estimate the difference in frequencies by studying the orbits of two
points, <span class="math inline">\(r+\delta r\)</span> and <span
class="math inline">\(r-\delta r\)</span>. This would then lead to:
<span class="math display">\[\Delta f \propto \left(\left(r+\delta
r\right)^3 - \left(r-\delta r\right)^3\right).\]</span> Through
performing two Taylor expansions by assuming that <span
class="math inline">\(\delta r &lt;&lt; r\)</span> and substituting
<span class="math inline">\(T_{\mathrm{dyn}}\)</span> for <span
class="math inline">\(r^3\)</span>, we arrive to the relationship that:
<span class="math display">\[\tau_{\textrm{phase-mixing}} \approx
T_{\mathrm{dyn}}\left(1-6\frac{\delta r}{r}\right).\]</span> For the
case of the globular clusters, a typical scale size is five parsecs,
while their orbital radii are on the scale of kilo-parsecs. This large
difference in size renders the characteristic time for phase mixing to
be approximately equivalent to a dynamical time, <span
class="math inline">\(\tau_{\textrm{phase-mixing}} \approx
T_{\mathrm{dyn}}\)</span>.</p>
<p>While this quick analysis gives us some powerful insight, this <span
class="math inline">\(\tau_{\textrm{phase-mixing}}\)</span> time is an
under estimate. This is largely due to the fact that the gravitational
pull of the globular cluster keeps its star close. Thus, the real phase
mixing will be larger than the dynamical time. Nonetheless, this serves
as a first order guide. We expect that clusters whose <span
class="math inline">\(T_{\mathrm{dyn}}\)</span> is much less than the
duration of the simulation will have totally mixed tidal debris. Whereas
those with <span class="math inline">\(T_{\mathrm{dyn}}\)</span> is
comparable or less than the total simulation time will not have
phase-mixed debris and thus the escaped star particles will still reside
near the cluster.</p>
<div id="refs" class="references csl-bib-body hanging-indent"
role="doc-bibliography">
<div id="ref-1991RMxAA..22..255A" class="csl-entry"
role="doc-biblioentry">
Allen, Christine, and Alfredo Santillan. 1991. <span>“<span
class="nocase">An improved model of the galactic mass distribution for
orbit computations.</span>”</span> 22 (October):255.
</div>
<div id="ref-1986RMxAA..13..137A" class="csl-entry"
role="doc-biblioentry">
Allen, C., and M. A. Martos. 1986. <span>“<span class="nocase">A simple,
realistic model of the galactic mass distribution for
orbitcomputations.</span>”</span> 13 (December):137–47.
</div>
<div id="ref-2008gady.book.....B" class="csl-entry"
role="doc-biblioentry">
Binney, James, and Scott Tremaine. 2008. <em><span>Galactic Dynamics:
Second Edition</span></em>.
</div>
<div id="ref-2023A&amp;A...673A..44F" class="csl-entry"
role="doc-biblioentry">
Ferrone, Salvatore, Paola Di Matteo, Alessandra Mastrobuono-Battisti,
Misha Haywood, Owain N. Snaith, Marco Montuori, Sergey Khoperskov, and
David Valls-Gabaud. 2023. <span>“<span class="nocase">The e-TidalGCs
project. Modeling the extra-tidal features generated by Galactic
globular clusters</span>”</span> 673 (May):A44. <a
href="https://doi.org/10.1051/0004-6361/202244141">https://doi.org/10.1051/0004-6361/202244141</a>.
</div>
<div id="ref-1990ApJ...356..359H" class="csl-entry"
role="doc-biblioentry">
Hernquist, Lars. 1990. <span>“<span class="nocase">An Analytical Model
for Spherical Galaxies and Bulges</span>”</span> 356 (June):359. <a
href="https://doi.org/10.1086/168845">https://doi.org/10.1086/168845</a>.
</div>
<div id="ref-2017MNRAS.465...76M" class="csl-entry"
role="doc-biblioentry">
McMillan, Paul J. 2017. <span>“<span class="nocase">The mass
distribution and gravitational potential of the Milky Way</span>”</span>
465 (1): 76–94. <a
href="https://doi.org/10.1093/mnras/stw2759">https://doi.org/10.1093/mnras/stw2759</a>.
</div>
<div id="ref-1975PASJ...27..533M" class="csl-entry"
role="doc-biblioentry">
Miyamoto, M., and R. Nagai. 1975. <span>“<span
class="nocase">Three-dimensional models for the distribution of mass in
galaxies.</span>”</span> 27 (January):533–43.
</div>
<div id="ref-2017A&amp;A...598A..66P" class="csl-entry"
role="doc-biblioentry">
Pouliasis, E., P. Di Matteo, and M. Haywood. 2017. <span>“<span
class="nocase">A Milky Way with a massive, centrally concentrated thick
disc: new Galactic mass models for orbit computations</span>”</span> 598
(February):A66. <a
href="https://doi.org/10.1051/0004-6361/201527346">https://doi.org/10.1051/0004-6361/201527346</a>.
</div>
</div>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>Chapter 18 of <a href="galaxiesbook.org"
class="uri">galaxiesbook.org</a> has largely inspired this discussion.<a
href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</body>
</html>
