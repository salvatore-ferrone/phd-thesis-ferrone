<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Theory</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Theory</h1>
</header>
<p>In this chapter, I present the theoretical background necessary to
understand the modeling of globular clusters and stellar streams
performed in this thesis. Much of the content draws from two
comprehensive introductions to galactic dynamics: Galactic Dynamics by
Binney and Tremaine, and Galaxiesbook.org by Bovy. These references
provide a solid foundation for the physics and mathematical tools used
throughout this work.</p>
<p>A common assumption in galactic dynamics is the so-called fluid
limit, in which the orbit of a star is determined by the smooth
gravitational potential generated by the galaxy as a whole. In this
approximation, interactions between individual stars are negligible.
This assumption holds well in many contexts—but not in all.</p>
<p>Globular clusters are a notable exception. Their relatively small
number of stars makes them too “grainy” for the fluid approximation to
hold, yet they contain far too many stars to be treated as simple
few-body systems. This intermediate regime is the subject of the aptly
named Million Body Problem, explored in detail by Heggie and Hut. Their
textbook provides a thorough survey of methods to address this
challenge, and their preface offers an insightful summary of the central
difficulty: globular clusters inhabit an awkward middle ground where
neither the fluid limit nor simplified few-body interactions apply
cleanly. As a result, no analytical theory fully captures their
dynamics.</p>
<p>While this thesis focuses primarily on stellar streams—specifically,
how stars escape from globular clusters and evolve under the influence
of the galactic potential—it is important to acknowledge that the
internal evolution of the progenitor clusters still affects the
properties of the streams. Although the internal cluster dynamics lie
outside the scope of this work, they place important constraints on the
interpretation of our results.</p>
<p>The remainder of this chapter is structured to clarify the
theoretical framework supporting this thesis. I divide the discussion
into three main parts:</p>
<ul>
<li><p><strong>Explicit physics</strong> - the physical laws and initial
conditions implemented in the simulations;</p></li>
<li><p><strong>Implicit physics</strong> - the emergent behavior of
these systems, the assumptions involved, and the mathematical tools used
to interpret the results;</p></li>
<li><p><strong>Ignored physics</strong> - relevant aspects of the
problem that are beyond the scope of this thesis, but which impact the
interpretation of our results. Where appropriate, I cite works that
pursue these directions and discuss how future work could incorporate
them to improve upon the current modeling.</p></li>
</ul>
<h1 id="the-explicit-physics">The Explicit Physics</h1>
<p>My simulations solve the <em>restricted three-body problem</em>. In
this setup, the host galaxy is treated as the primary body, fixed at the
origin of the coordinate system, which corresponds to the system’s
center of mass. The galaxy exerts a gravitational force on both the
globular cluster—modeled as a single center of mass—and on all
individual star particles.</p>
<p>The globular cluster is approximated as a smooth density distribution
that influences the star particles, rather than as a collection of stars
interacting with one another. This simplification significantly reduces
the computational cost. Moreover, all star particles are integrated
independently, without interacting with one another. In effect, the full
N-body problem is approximated as <span class="math inline">\(N\)</span>
independent instances of the restricted three-body problem. Figure <a
href="#fig:restricted_three_body_set_up" data-reference-type="ref"
data-reference="fig:restricted_three_body_set_up">1</a> illustrates the
schematic configuration of the system.</p>
<figure id="fig:restricted_three_body_set_up">
<img src="images/restricted_three_body_set_up.png" />
<figcaption>Schematic illustration of the equations of motion. The
system is simplified to three interacting bodies: the Galaxy (primary),
the globular cluster (secondary), and an individual star (tertiary). Red
vectors indicate forces that are neglected in the equations of motion.
Since the stars are assumed to exert no force on one another or on the
cluster, their number can be scaled up arbitrarily to sample the net
gravitational field of the cluster and the Galaxy.</figcaption>
</figure>
<h2 id="subsec:myEquationsOfMotion">Equations of Motion</h2>
<p>Orbits in this system begin with the variational principle of
Lagrangian mechanics. The full interacting system includes the kinetic
energy of the globular cluster and the star particle, as well as three
gravitational potential energy terms: the cluster-galaxy interaction,
the particle-galaxy interaction, and the particle-cluster
interaction.</p>
<p><span class="math display">\[\mathcal{L} = \frac{1}{2} M_{\rm gc}
\dot{\mathbf{R}}_{\rm gc}^2
                        + \frac{1}{2} m \dot{\mathbf{r}}^2
                        - M_{\rm gc} \Phi_{\rm gal}(\mathbf{R}_{\rm gc})
                        - m \Phi_{\rm gal}(\mathbf{r})
                        - m \Phi_{\rm gc}(\mathbf{r} - \mathbf{R}_{\rm
gc})\]</span></p>
<p>For simplicity, let us treat the globular cluster as a point mass. In
this case, the gravitational potential energy between the cluster and
the star is:</p>
<p><span class="math display">\[U_{\rm star-gc} = - \frac{G M_{\rm gc}
m}{|\mathbf{r} - \mathbf{R}_{\rm gc}|}\]</span></p>
<p>In this thesis, I decouple the equations of motion of the globular
cluster and the star. The justification for this approximation is
evident when we normalize the Lagrangian by the cluster mass, <span
class="math inline">\(M_{\rm gc}\)</span>. This yields:</p>
<p><span class="math display">\[\frac{\mathcal{L}}{M_{\rm gc}} =
\frac{1}{2} \dot{\mathbf{R}}_{\rm gc}^2
                                        - \Phi_{\rm gal}(\mathbf{R}_{\rm
gc})
                                        + \underbrace{\frac{m}{M_{\rm
gc}} \left[ \frac{1}{2} \dot{\mathbf{r}}^2
                                        - \Phi_{\rm gal}(\mathbf{r})
                                        - \Phi_{\rm gc}(\mathbf{r} -
\mathbf{R}_{\rm gc}) \right]}_{\text{negligible correction to GC&#39;s
motion}}\]</span></p>
<p>In the limit where <span class="math inline">\(m \ll M_{\rm
gc}\)</span>, the terms in brackets become negligible, and the star’s
motion has no back-reaction on the cluster. The Lagrangian for the
cluster’s orbit thus becomes:</p>
<p><span
class="math display">\[\frac{\mathcal{L}_{\mathrm{gc}}}{M_{\mathrm{gc}}}
= \frac{1}{2} \dot{\mathbf{R}}_{\rm gc}^2
                                - \Phi_{\rm gal}(\mathbf{R}_{\rm
gc})\]</span></p>
<p>Switching to the star’s perspective, we normalize the Lagrangian by
the particle mass <span class="math inline">\(m\)</span>, obtaining:</p>
<p><span class="math display">\[\frac{\mathcal{L}_{\rm star}}{m} =
\frac{1}{2} \dot{\mathbf{r}}^2
                                - \Phi_{\rm gal}(\mathbf{r})
                                - \Phi_{\rm gc}(\mathbf{r} -
\mathbf{R}_{\rm gc}(t))\]</span></p>
<p>Here, the cluster’s influence on the particle is retained through its
time-dependent position <span class="math inline">\(\mathbf{R}_{\rm
gc}(t)\)</span>. This influence becomes important when the gravitational
forces from the cluster and the galaxy on the particle are comparable.
For a quick estimate, we treat both the galaxy and the cluster as point
masses. The two forces become comparable when the particle is
sufficiently close to the cluster, which occurs when:</p>
<p><span class="math display">\[|\delta \mathbf{r}| \approx &lt;
\sqrt{\frac{M_{\mathrm{gc}}}{M_{\mathrm{ gal}}}}
|\mathbf{r}|.\]</span></p>
<p>That is, the cluster’s gravitational field dominates over the
galaxy’s on sufficiently small scales around the cluster — as expected.
For a quick sanity check: a typical globular cluster may have a mass of
<span class="math inline">\(10^5\, M_\odot\)</span>, while the galaxy
may be around <span class="math inline">\(10^{11}\, M_\odot\)</span>. If
the cluster is a few kiloparsecs from the galactic center, then the
cluster’s influence dominates within a region of order a few parsecs —
which checks out. A better limit is the tidal radius and is presented in
the next section.</p>
<p>While Lagrangian mechanics is rooted in first principles, working in
the Hamiltonian formalism often provides deeper insight into the physics
of the system. Additionally, Hamiltonian mechanics reduces the equations
of motion to a set of <span class="math inline">\(2N\)</span>
first-order differential equations, rather than <span
class="math inline">\(N\)</span> second-order ones, which is more
convenient for computational integration.</p>
<p>If we use the <em>specific</em> Lagrangian—normalized by the mass of
the body of interest—then the conjugate momenta reduce to the
velocities. The Hamiltonian can then be obtained via a Legendre
transform: <span class="math display">\[\mathcal{H} = \sum p_i \dot{q}_i
- \mathcal{L}.\]</span></p>
<p>Another useful result comes from Noether’s theorem: if a coordinate
does not explicitly appear in the Lagrangian, its conjugate momentum is
conserved. In our case, once we define the potential (see next section)
and adopt cylindrical coordinates, we find that the Lagrangian does not
depend on the azimuthal angle <span
class="math inline">\(\theta\)</span> in the <span
class="math inline">\(x\text{-}y\)</span> plane for the cluster’s
motion. This implies conservation of the <span
class="math inline">\(z\)</span>-component of angular momentum: <span
class="math display">\[p_\theta = L_z = \frac{\partial
\mathcal{L}}{\partial \dot{\theta}} = R^2 \dot{\theta}.\]</span></p>
<p>This conservation generally does not hold for star particles within
the globular cluster, as their dynamics are significantly influenced by
the cluster’s gravitational potential. However, it is recovered in the
regime where their motion becomes dominated by the galaxy’s potential
rather than the cluster’s.</p>
<p>The core task, then, is to compute the forces acting on either the
particle or the cluster, which are given by the partial derivatives of
the Hamiltonian with respect to the generalized coordinates: <span
class="math display">\[\dot{p}_i = -\frac{\partial \mathcal{H}}{\partial
q_i}.\]</span></p>
<p>In practice, all equations of motion are solved in Cartesian
coordinates. However, it is often instructive to analyze the system in
cylindrical coordinates, where the symmetry of the galactic potential
becomes more apparent. This symmetry and its consequences will be
discussed in the following section.</p>
<h2 id="potential-density-pairs">Potential density pairs</h2>
<p>The fundamental equation governing Newtonian gravity is Poisson’s
equation: <span class="math display">\[\nabla^2 \Phi = 4\pi G
\rho,\]</span> which generalizes Newton’s law of gravity from point
masses to continuous mass distributions. One of the powerful properties
of this equation is its linearity, allowing arbitrary mass distributions
to be decomposed into individual components whose contributions to the
gravitational potential can be summed: <span
class="math display">\[\nabla^2 \left(a_0\Phi_0 + a_1\Phi_1 \right) =
a_0 \nabla^2 \Phi_0 + a_1 \nabla^2 \Phi_1 = 4\pi G \left(a_0\rho_0
+a_1\rho_1\right).\]</span></p>
<p>It is instructive to compare stellar dynamics—the motion of stars in
galaxies—with celestial mechanics—the motion of planets and spacecraft
within the Solar System. In celestial mechanics, the gravitational field
is known to high precision. Typically, one begins by considering the
dominant mass (the Sun) and includes additional bodies only as needed.
For instance, to place the James Webb Space Telescope at the Sun-Earth
L2 Lagrange point, first-order calculations involve only the Sun and
Earth. Likewise, when studying the long-term evolution of comet orbits,
it may suffice to include only the Sun, Jupiter, and possibly Saturn. In
these cases, the restricted three- or four-body problem provides a good
approximation.</p>
<p>In contrast, the Milky Way’s gravitational potential is not precisely
known and is far more complex. The Galaxy is not merely a collection of
point masses; instead, it consists of billions of stars, gas, and dark
matter, which collectively form structured components. Each of these
components is represented with its own potential-density pair. While
various methods exist to model the Galactic potential, most approaches
adopt parameterized functions for each component. Notable examples
include the widely used models of McMillan (2017) and Bovy (2015).</p>
<p>The Galaxy is typically modeled as a superposition of several
distinct components:</p>
<ul>
<li><p>the bulge a dense, roughly spherical central concentration of
stars;</p></li>
<li><p>the disk, where most of the stars and gas lie, with an
approximately axisymmetric, flattened distribution;</p></li>
<li><p>the halo which includes both the stellar halo and the dark matter
halo.</p></li>
</ul>
<p>More elaborate models further subdivide these components and can
include time-dependent features. For example, the Galactic bar can be
modeled as a rotating triaxial or prolate ellipsoid with a time-varying
orientation. Moving substructures such as molecular clouds, dwarf
galaxies, or dark matter subhalos can also be included. In my
simulations, the globular cluster is treated as one such additional
component, introduced on top of the smooth background.</p>
<p>When simple analytic potentials are insufficient—especially for
capturing non-axisymmetric or irregular features—basis function
expansions can be employed. For instance, in spherical coordinates, one
may use eigenfunctions of the Laplacian (e.g., spherical harmonics) to
build the potential. Similarly, in cylindrical coordinates, Bessel
functions naturally arise as solutions to the Laplacian and are well
suited for modeling disks. (Cite Arpit’s recent paper)</p>
<p>A common starting point when constructing gravitational potential
models is to choose either the functional form of the density <span
class="math inline">\(\rho(\vec{x})\)</span> and solve Poisson’s
equation to obtain the potential <span
class="math inline">\(\Phi(\vec{x})\)</span>, or vice versa. In
practice, it is often simpler to specify a potential and then derive the
corresponding density by differentiation, since solving Poisson’s
equation analytically is usually more tractable than performing the
required integrals in the reverse direction.</p>
<p>In this thesis, I adopt the Galactic potential model of Pouliasis et
al. (2017), which builds upon the earlier model by Allen &amp; Santillan
(1991) and incorporates improved fits to more recent observational
constraints. The Galactic disk is modeled using the Miyamoto-Nagai
potential: <span class="math display">\[\Phi(R, z \mid M, a, b) =
-\frac{G M}{\sqrt{R^2 + \left(a + \sqrt{z^2 + b^2}\right)^2}},\]</span>
where <span class="math inline">\(M\)</span> is the total mass of the
disk, <span class="math inline">\(a\)</span> is the radial scale length,
and <span class="math inline">\(b\)</span> is the vertical scale height.
This form smoothly interpolates between a flattened disk and a spherical
distribution depending on the values of <span
class="math inline">\(a\)</span> and <span
class="math inline">\(b\)</span>. In the limit <span
class="math inline">\(a \to 0\)</span>, the Miyamoto-Nagai potential
reduces to the Plummer potential: <span class="math display">\[\Phi(r
\mid M, b) = -\frac{G M}{\sqrt{r^2 + b^2}},\]</span> which I use to
model globular clusters in this work. The Plummer model provides a
simple spherically symmetric mass distribution with a finite central
density and a total mass that asymptotes at large radii. Interestingly,
the Plummer potential is mathematically equivalent to a softened
gravitational potential, commonly used in <span
class="math inline">\(N\)</span>-body simulations to regularize close
encounters between particles.</p>
<p>The dark matter halo is modeled separately and selected to reproduce
the observed flat rotation curve of the Milky Way at large radii. This
requirement translates into a mass profile that grows linearly with
radius (<span class="math inline">\(M(r) \propto r\)</span>) in the
outer regions. A class of density profiles known as double power-law
models satisfies this condition: <span class="math display">\[\rho(r
\mid \alpha, \beta, r_s) = \rho_0 \left( \frac{r}{r_s} \right)^{-\alpha}
\left(1 + \frac{r}{r_s} \right)^{\alpha - \beta},\]</span> where <span
class="math inline">\(r_s\)</span> is a scale radius, <span
class="math inline">\(\alpha\)</span> controls the inner slope, and
<span class="math inline">\(\beta\)</span> the outer slope. Common
choices include the NFW profile (<span class="math inline">\(\alpha =
1\)</span>, <span class="math inline">\(\beta = 3\)</span>) and the
Hernquist profile <span class="math inline">\((\alpha = 1\)</span>,
<span class="math inline">\(\beta = 4)\)</span>.</p>
<p>The potential presented in Allen Santillan uses the Martos halo,
which is not of the same functional family of the two power-law density
model, but nonetheless has similar properties. The Martos halo is
defined by a parameterized enclosed mass function: <span
class="math display">\[M_{\mathrm{enc}}(r|M_0,\gamma,r_0,r_c) = M_0
            \begin{cases}
             \frac{\left(r/r_0\right)^\gamma}{1 +
\left(r/r_0\right)^{\gamma - 1}} &amp; r&lt;r_c,\\
             \frac{\left(r_c/r_0\right)^\gamma}{1 +
\left(r_c/r_0\right)^{\gamma - 1}} &amp; r&gt; r_c,\\
            \end{cases}
            \label{eq:martos_enclosed_mass}\]</span> where <span
class="math inline">\(M_0\)</span> is a mass scaling parameter (not the
total mass), <span class="math inline">\(r_0\)</span> is the
characteristic radius, <span class="math inline">\(\gamma\)</span> is
the exponental parameter, and <span class="math inline">\(r_c\)</span>
is a cutoff radius beyond which the mass is held constant. Thus, for
<span class="math inline">\(r &gt; r_c\)</span> Eq. <a
href="#eq:martos_enclosed_mass" data-reference-type="ref"
data-reference="eq:martos_enclosed_mass">[eq:martos_enclosed_mass]</a>
reports the total mass. In the outer regime <span
class="math inline">\((r/r_0) &gt;&gt; 1\)</span>, the enclosed mass
scales as <span class="math inline">\(M(r) \propto r\)</span>, producing
a flat rotation curve. In the inner regime <span
class="math inline">\((r/r_0) &lt;&lt; 1\)</span>, the mass grows as a
power law, <span class="math inline">\(M(r) \propto r^{\gamma -
1}\)</span>, which provides flexibility in shaping the central density
slope. Since the unmodified profile leads to an unphysical divergence in
total mass, a truncation at <span class="math inline">\(r_c\)</span> is
imposed. When the potential has spherical symmetry we may use the
relation <span class="math inline">\(\nabla \Phi = \frac{G
M_{\mathrm{enc}}(r)}{r^2}\)</span>, and requiring that the potential
vanish at infinity, the corresponding gravitational potential can be
obtained by integrating:</p>
<p><span class="math display">\[\Phi(r|M_0,\gamma,r_0,r_c) =
            \begin{cases}
                \frac{GM_0}{r_0\left(\gamma-1\right)}\ln\left|\frac{1+(r/r_0)^{\gamma-1}}{1+(r_c/r_0)^{\gamma-1}}\right|
-\frac{GM_t}{r_c}, &amp; r&lt;r_c\\
                -GM_t/r &amp; r&gt;r_c.
            \end{cases}\]</span> Two Miyamoto-Nagai disks plus the
Martos halo compose the second potential model presented in
Pouliasis2017pii and is presented in Fig. <a
href="#fig:figure_pouliasis2017pii_potential" data-reference-type="ref"
data-reference="fig:figure_pouliasis2017pii_potential">2</a>.</p>
<figure id="fig:figure_pouliasis2017pii_potential">
<img src="images/figure_pouliasis2017pii_potential_-8_8.png" />
<figcaption>Individual components of the second Galactic potential model
from Pouliasis et al. (2017). The parameters used are listed in Table
XXX. The vector field illustrates the normalized gravitational force at
each position, corresponding to <span class="math inline">\(\vec{g} =
-\nabla\Phi\)</span>. Equipotential contour lines are overlaid to guide
the eye.</figcaption>
</figure>
<h2 id="the-collisionless-botlzmann-equation">The Collisionless
Botlzmann Equation</h2>
<p>In this section, I want to show how we obtain the distribution of
stars that populate the globular clusters used in these models.
Specifically, I’ll walk through the assumptions that reduce the general
phase-space distribution to the simpler, tractable case relevant to our
needs.</p>
<p>In galactic dynamics, a fundamental challenge is the
<em>self-consistency problem</em>. This involves a loop of three steps:
(1) Given a density distribution and a gravitational potential (linked
via Poisson’s equation), one samples the positions of stars. (2) One
then assigns initial velocities and evolves the system forward in time.
(3) The potential is updated based on the evolved mass distribution.</p>
<p>If the system is in equilibrium and self-consistent, then the mass
distribution remains stable under its own gravity. That is, the same
density that generated the potential continues to persist as the system
evolves. Crucially, while the mass density may be known, the velocities
are not given a priori. To determine the velocity distribution, we turn
to the Collisionless Boltzmann Equation (CBE).</p>
<p>Our starting point is to characterize the system statistically, with
a distribution function (DF) over phase space. That is, what is the
probability density of finding a particle at a given position and
velocity? This is encoded in the function <span
class="math inline">\(f(\vec{x}, \vec{v}, t)\)</span>. If we treat this
as a true probability density function that integrates to 1 over all
phase space, we are implicitly assuming a closed system: no stars enter,
leave, are born, or die.</p>
<p>Already, by writing <span class="math inline">\(f(\vec{x}, \vec{v},
t)\)</span>, we are assuming that a particle’s phase-space position is
independent of any other attributes — such as mass. Let us define <span
class="math inline">\(\mathbf{w} = (\vec{x}, \vec{v})\)</span> as the 6D
phase-space coordinate. Then, for a system of <span
class="math inline">\(N\)</span> particles, the full distribution
function lives in <span class="math inline">\(6N\)</span>-dimensional
space: <span class="math display">\[f(\mathbf{w}_1, \dots,
\mathbf{w}_N)\]</span> This expression represents the joint probability
density of finding particle 1 at <span
class="math inline">\(\mathbf{w}_1\)</span>, particle 2 at <span
class="math inline">\(\mathbf{w}_2\)</span>, and so on. In general, this
object can be extremely complicated. But we can simplify it with two
strong assumptions: that particles are independent and identically
distributed (i.i.d.). This leads to:</p>
<p><span class="math display">\[\begin{array}{rl}
        f
        &amp; \stackrel{\text{(1) $N$-body DF}}{\longrightarrow}
        f(\mathbf{w}_1, \dots, \mathbf{w}_N) \\[2ex]
        &amp; \stackrel{\text{(2) independence}}{\longrightarrow}
        \prod_{i=1}^N f^i(\mathbf{w}_i) \\[2ex]
        &amp; \stackrel{\text{(3) identical
distribution}}{\longrightarrow}
        \left[ f(\mathbf{w}) \right]^N
        \end{array}\]</span></p>
<p>The consequence of this factorization is that the total DF no longer
accounts for correlations in other variables — such as mass. Therefore,
this model cannot represent mass segregation, multiple populations, or
any other effects that differentiate stars. Instead, we describe a
single homogeneous population of stars, each drawn independently from
the same distribution.</p>
<p>Because of this, we can focus our attention entirely on the
single-particle DF <span class="math inline">\(f(\mathbf{w})\)</span>,
which encodes all the statistical information we need about the
system.</p>
<p>The next key assumption is that particles are uncorrelated not just
in identity, but dynamically — they do not scatter off one another. This
means the system is <em>collisionless</em>. The DF then evolves under
the Collisionless Boltzmann Equation:</p>
<p><span class="math display">\[\frac{Df}{Dt} = \frac{\partial
f}{\partial t} + \dot{\mathbf{x}} \cdot \nabla_{\mathbf{x}} f +
\dot{\mathbf{v}} \cdot \nabla_{\mathbf{v}} f = 0\]</span></p>
<p>This is a material (Lagrangian) derivative following a phase-space
trajectory. The physical interpretation is that the DF is conserved
along the orbits of stars in phase space. No bunching up, no spreading
out — stars simply move under the influence of a smooth, mean
gravitational potential.</p>
<p>Next, we often impose the equilibrium condition: <span
class="math display">\[\frac{\partial f}{\partial t} = 0\]</span> This
implies that the DF is time-independent: the number of stars at any
given phase-space location remains constant. If some leave a region,
others must replace them. This assumption is only valid in isolation —
for instance, in an isolated galaxy or globular cluster. It is violated
during mergers or tidal disruptions. In my simulations, I model such
disruptions, so this assumption is not globally valid. However, I begin
with an equilibrium system and study how it departs from equilibrium
numerically.</p>
<p>Now, let us focus on globular clusters. These are often modeled as
spherically symmetric systems. However, spherical symmetry in density
does not imply isotropy in velocity. A system can be spherically
symmetric but have velocity anisotropy, meaning that orbits are
preferentially radial or circular. This is quantified by the anisotropy
parameter <span class="math inline">\(\beta\)</span>. In my simulations,
I assume isotropy, meaning that the DF depends only on the energy <span
class="math inline">\(E\)</span>. Thus, we write:</p>
<p><span class="math display">\[f(\mathbf{w}) = f(E)\]</span></p>
<p>At this point, it is useful to mention Jeans equations, which relate
the moments of the DF to observable quantities. By integrating the DF
over all velocities, we recover the spatial mass density:</p>
<p><span class="math display">\[\rho(\mathbf{r}) = M \int f(\mathbf{x},
\mathbf{v}) \, d^3\mathbf{v}\]</span></p>
<p>In fact, for isotropic spherical systems, an inversion formula exists
— known as the Abel transform — that allows one to reconstruct <span
class="math inline">\(f(E)\)</span> from a known <span
class="math inline">\(\rho(r)\)</span>. This technique is presented in
Binney &amp; Tremaine and also in Bovy’s online book. At this point, one
can obtain a complete analytic expression for the distribution function.
With this in mind, a discrete set of positions and velocities can be
sampled and is presented in the next chapter.</p>
<h1 id="the-implicit-physics">The Implicit Physics</h1>
<h2 id="the-planar-circular-restricted-three-body-problem">The Planar
Circular Restricted Three-Body Problem</h2>
<p>Even if we simplify the simulation by modeling the cluster as <span
class="math inline">\(\mathcal{N}\)</span> independent three-body
problems, the problem remains challenging. Indeed, if we consider all
three bodies to have mass, we can write down a Hamiltonian with 18
dimensions: three positions and three momenta in <span
class="math inline">\(\mathcal{R}^3\)</span> for each particle. The
dimensionality of the problem can be reduced by using the conservation
of total linear momentum and total angular momentum, and by expressing
the dynamics in terms of relative coordinates about the system’s center
of mass. This reduces the total dimensionality to 9. Nevertheless, the
problem remains analytically intractable due to its high dimensionality.
To gain analytical insight, we simplify the system further.</p>
<p>Instead of writing the full Lagrangian for the three-body motion, we
focus on the third particle subject to the gravitational influence of
the two massive bodies, in an inertial reference frame centered at the
system’s center of mass. The Lagrangian then contains the kinetic energy
of the third particle and two gravitational potential energy terms from
the primary and secondary. However, since the positions and momenta of
the primaries are not treated as dynamical variables in our system, they
appear as explicit functions of time, making the Lagrangian
non-autonomous. This implies that the corresponding Hamiltonian is
time-dependent and the total energy of the third particle is not
conserved, as the primaries can exchange energy with it.</p>
<p>We introduce a further simplifying assumption: the two primaries move
on circular orbits. Under this assumption, we transform to a reference
frame rotating with the primaries, placing them along the <span
class="math inline">\(x-axis\)</span>. In this rotating frame, the
Lagrangian becomes autonomous; it no longer depends explicitly on time
and requires no external information to determine the particle’s
subsequent motion.</p>
<p>Two effects make this possible. First, by moving to the rotating
frame, we introduce non-inertial forces: the Coriolis force and the
centrifugal force. The centrifugal force is conservative, associated
with a scalar potential. The Coriolis force depends on the particle’s
velocity as <span class="math inline">\(2\omega\times v\)</span>, but
because it is always perpendicular to the velocity, it does no work and
thus does not change the particle’s kinetic energy. After performing the
coordinate transformation, the canonical momenta—now
position-dependent—can be derived. The resulting Hamiltonian is: <span
class="math display">\[\mathcal{H} = \frac{1}{2}\left(\left(p_x + \omega
y\right)^2 + \left(p_y - \omega x\right)^2 \right) +
\Phi_\mathrm{eff}(x,y),\]</span> where <span
class="math display">\[\Phi_\mathrm{eff}(x,y) = -\frac{1}{2} \omega^2
(x^2 + y^2) - \frac{G m_1}{|r_1|} - \frac{G m_2}{|r_2|}.\]</span></p>
<p>The potential can be normalized by noting that the orbital angular
velocity from the two-body problem satisfies <span
class="math inline">\(\omega^2 = \frac{G M}{a^3}\)</span>, where <span
class="math inline">\(a\)</span> is the separation between the primaries
and <span class="math inline">\(M = m_1 + m_2\)</span> is the total mass
of the system. With this normalization, the system depends on a single
dimensionless parameter <span class="math inline">\(\mu\)</span>, the
relative mass ratio defined as <span class="math inline">\(\mu =
\frac{m_2}{m_1 + m_2}\)</span>.</p>
<p>At this point, the system can be studied qualitatively.
Unfortunately, no general closed-form solution exists for the circular
restricted three-body problem that describes the subsequent motion as a
function of time. However, by studying the effective potential <span
class="math inline">\(\Phi_\mathrm{eff}\)</span>, we gain valuable
insights.</p>
<p>Our Hamiltonian depends on the four variables <span
class="math inline">\((x, y, p_x, p_y)\)</span> and has one integral of
motion.<a href="#fn1" class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a> A famous quantity in this context is
the Jacobi integral (or Jacobi constant), often written as <span
class="math inline">\(C_j = -2E\)</span>. Defining this constant is
somewhat arbitrary since the total mechanical energy <span
class="math inline">\(E\)</span> is itself conserved, and any scalar
multiple of it is also conserved. The utility of the Jacobi constant is
mostly conventional: it is often defined to be positive and multiplied
by 2, which simplifies the expression for forbidden regions and
zero-velocity curves. For example, one can write <span
class="math display">\[\dot{x}^2 + \dot{y}^2 = 2 \Phi_\mathrm{eff}(x,y)
+ C_j,\]</span> instead of the equivalent <span
class="math display">\[\dot{x}^2 + \dot{y}^2 = -2 \Phi_\mathrm{eff}(x,y)
+ 2E.\]</span></p>
<p>Since we have four variables and one constraint, the motion is
restricted to a three-dimensional hypersurface (or manifold) embedded in
the four-dimensional phase space.</p>
<p>At this stage, we find the points where <span
class="math inline">\(\nabla \Phi_\mathrm{eff} = 0\)</span>, which
correspond to the Lagrange points—locations where all effective forces
balance. Of particular importance are the first two Lagrange points
<span class="math inline">\(L_1\)</span> and <span
class="math inline">\(L_2\)</span>, which lie along the line connecting
the primary and secondary. The effective potential at <span
class="math inline">\(L_1\)</span> is lower than at <span
class="math inline">\(L_2\)</span>.</p>
<p>Given a certain energy level, setting the kinetic energy to zero
defines boundaries between regions where the particle can and cannot
move. Regions where the kinetic energy would have to be negative (which
is physically impossible) are forbidden, since that would require
imaginary velocities.</p>
<p>The points <span class="math inline">\(L_1\)</span> and <span
class="math inline">\(L_2\)</span> are especially important for our
study of a globular cluster with stars initially bound to it. Stars can
escape through these Lagrange points: lower-energy particles tend to
escape through <span class="math inline">\(L_1\)</span>, while
higher-energy particles can also escape through <span
class="math inline">\(L_2\)</span>. Figure <a
href="#fig:CR3BP_forbidden_region" data-reference-type="ref"
data-reference="fig:CR3BP_forbidden_region">3</a> illustrates these
forbidden and allowed regions clearly.</p>
<figure id="fig:CR3BP_forbidden_region">
<p><img src="images/CR3BP_forbidden_region_0.png" alt="image" /> <img
src="images/CR3BP_forbidden_region_1.png" alt="image" /> <img
src="images/CR3BP_forbidden_region_2.png" alt="image" /></p>
<p><img src="images/CR3BP_forbidden_region_3.png" alt="image" /> <img
src="images/CR3BP_forbidden_region_4.png" alt="image" /></p>
<figcaption>A reproduction of Fig. 2.4.2 from <span class="citation"
data-cites="koon2000dynamical">Koon et al. (2000)</span>. Each plot is
shown in the non-inertial reference frame rotating with the orbital
frequency of the primary and secondary about their common center of
mass. In this example, the mass ratio is <span class="math inline">\(m_1
= 10 m_2\)</span>. The gray regions represent areas inaccessible to the
test particle for a given energy. In the first case, where <span
class="math inline">\(E &lt; E_1\)</span>, the particle remains confined
to orbit either around the primary or the secondary, depending on its
initial position. As the particle’s energy increases, more of the <span
class="math inline">\(xy\)</span>-plane becomes accessible. The narrow
passage between <span class="math inline">\(m_1\)</span> and <span
class="math inline">\(m_2\)</span> corresponds to the <span
class="math inline">\(L_1\)</span> Lagrange point, while the choke point
allowing escape to the exterior when <span class="math inline">\(E &gt;
E_2\)</span> is the <span class="math inline">\(L_2\)</span>
point.</figcaption>
</figure>
<p>The distance from the secondary to the first and second Lagrange
points is approximately equal, defining a region around the secondary
known as the Hill sphere. Within this zone, the gravitational influence
of the secondary dominates over that of the primary. The Hill radius is
commonly approximated as <span class="math inline">\(r_h \approx
r\sqrt[3]{m_2/m_1}\)</span>, where <span
class="math inline">\(r\)</span> is the separation between the
primaries. Interestingly, the expression for the Hill radius arises from
a fifth-order polynomial expansion of the effective potential—a detail
that might seem minor, but is actually quite delightful. In most areas
of physics, approximations typically stem from Taylor expansions, basis
function decompositions, or limits where the governing equations
simplify.</p>
<p>It is tempting to wonder whether a particle that escapes from the
vicinity of the secondary can be recaptured. Indeed, within the
simplified framework of the circular restricted three-body problem,
recapture is possible. Once the initial conditions—position and
momentum—are specified, the subsequent motion is fully determined by
Hamilton’s equations. While no general analytical solution exists, the
uniqueness theorem ensures that the system’s evolution is deterministic.
Therefore, for a given total energy, we can identify the accessible
regions in configuration space, bounded by the zero-velocity surfaces.
This implies that the fate of the particle—whether it remains bound or
escapes—is encoded in the initial conditions.</p>
<p>In the context of celestial mechanics, particularly for applications
such as spacecraft trajectory design, more sophisticated tools exist to
analyze escape conditions and transfer orbits, including invariant
manifolds and dynamical systems techniques. These are invaluable in the
solar system regime, where the mass ratio is extreme and the test
particle is typically a spacecraft or small body. However, in stellar
and galactic dynamics, the situation differs substantially. The
assumptions underpinning those techniques often break down, and the
complexity of the gravitational potential increases. In this regime, it
is more insightful to think of tidal forces as the underlying mechanism
that gradually transfers energy and angular momentum, nudging stars
across the Lagrange boundaries and ultimately driving escape. It is to
this process—tidal stripping—that we now turn.</p>
<p><strong>NOTE from Ferrone. I wonder if the <span
class="math inline">\(L_4\)</span> and <span
class="math inline">\(L_5\)</span> exist in the galactic context... are
there Tojan stars? or does the complexity of the galactic potential
paired with non circular orbits render such a phenomena
unnatural?</strong></p>
<h2 id="the-tidal-tensor">The tidal tensor</h2>
<p>Tidal forces arise due to spatial variations in the gravitational
field and are especially apparent when comparing the accelerations
experienced by nearby particles. To explore this, consider a Taylor
expansion of the gravitational potential of the primary, <span
class="math inline">\(\Phi_g\)</span>, evaluated at the star’s position
<span class="math inline">\(\vec{x}_s\)</span>, relative to the
secondary’s position <span class="math inline">\(\vec{x}_c\)</span>:
<span class="math display">\[\Phi_g\left(\vec{x}_s\right) \approx
\Phi_g\left(\vec{x}_c\right) + \left[\nabla \Phi_g (\vec{x}_c)\cdot
\Delta \vec{x}\right] + \left[\Delta \vec{x} \cdot
\mathcal{D}^2\left(\Phi_g\right) \cdot \Delta\vec{x}\right],\]</span>
where <span class="math inline">\(\Delta \vec{x} = \vec{x}_s -
\vec{x}_c\)</span>, and <span class="math inline">\(\mathcal{D}^2
\Phi_g\)</span> is the Hessian matrix of second derivatives of the
potential: <span class="math inline">\(\partial^2 \Phi/\partial x_i
\partial x_j\)</span>.</p>
<p>An equivalent expression can be derived by linearizing the
gravitational force in a non-inertial frame co-moving with the
secondary. Let us write Newton’s second law for the star-particle and
the secondary in an inertial frame: <span
class="math display">\[\begin{aligned}
            \vec{F}_s &amp;= \nabla \Phi_c\left(\Delta \vec{x}\right) +
\nabla \Phi_g\left(\vec{x}_s\right),\\
            \vec{F}_c &amp;= \nabla \Phi_g\left(\vec{x}_c\right).
        
\end{aligned}\]</span> Then the relative acceleration of the star in the
non-inertial frame is: <span class="math display">\[\begin{aligned}
            \vec{f}_s &amp;= \vec{F}_s - \vec{F}_c +
\vec{F}_\mathrm{fictitious} \\
                    &amp;= \nabla \Phi_c\left(\Delta \vec{x}\right) +
\nabla \Phi_g\left(\vec{x}_s\right) - \nabla
\Phi_g\left(\vec{x}_c\right) + \vec{F}_\mathrm{fictitious} \\
                    &amp;\approx \nabla \Phi_c\left(\Delta
\vec{x}\right) + \mathrm{Jac}\left(\nabla \Phi_g(\vec{x}_c)\right) \cdot
\Delta \vec{x} + \vec{F}_\mathrm{fictitious},
        
\end{aligned}\]</span> where the last line uses a first-order Taylor
expansion of the gravitational force field, valid under the assumption
that <span class="math inline">\(|\Delta \vec{x}| \ll
|\vec{x}_c|\)</span>.</p>
<p>The Jacobian of the gravitational field is equal to the Hessian of
the potential, owing to the symmetry of second derivatives and the fact
that <span class="math inline">\(\vec{g} = -\nabla \Phi_g\)</span>. This
matrix, known as the <em>tidal tensor</em> <span
class="math inline">\(\mathcal{T}\)</span>, describes the linearized
spatial variation of the gravitational field: <span
class="math display">\[\mathcal{T} = -\mathcal{D}^2\Phi_g =
\mathrm{Jac}(\nabla \Phi_g) = \left(\begin{matrix}
                \partial_x g_x &amp; \partial_y g_x &amp; \partial_z g_x
\\
                \partial_x g_y &amp; \partial_y g_y &amp; \partial_z g_y
\\
                \partial_x g_z &amp; \partial_y g_z &amp; \partial_z g_z
            \end{matrix}\right).\]</span></p>
<p>While the Hessian and Jacobian are formally equivalent, the Jacobian
viewpoint offers a more geometric interpretation: it acts as a linear
transformation on nearby displacements, mapping them to differences in
acceleration. Diagonalizing the tidal tensor reveals the principal axes
of tidal deformation. A positive eigenvalue corresponds to stretching
along the associated eigenvector; a negative eigenvalue indicates
compression. The magnitude gives the rate of stretching or
compression.</p>
<p>Finally, we note that although many relevant potentials exhibit
spherical or cylindrical symmetry, Cartesian coordinates are preferred
here. In curvilinear systems, computing the Jacobian or Hessian requires
accounting for Christoffel symbols, which complicates the interpretation
and computation.</p>
<h3 class="unnumbered" id="the-moon">The Moon</h3>
<p>Nothing clarifies the concept of tides like the most familiar
example: the Moon. Tidal forces are invoked to explain a wide range of
phenomena in the Earth-Moon system. The most relatable effect is, of
course, the periodic variation in sea level on Earth. While accurately
modeling these changes requires fluid dynamics—beyond the scope of this
thesis—NASA provides several accessible explanations and visualizations
at <a
href="https://science.nasa.gov/moon/tides/">https://science.nasa.gov/moon/tides/</a>,
including daily high and low tides, as well as spring and neap
tides.</p>
<p>Another key example is the tidal deformation of the Moon, which
ultimately led to its tidal locking—explaining why we always see the
same side of the Moon from Earth.</p>
<p>A particularly insightful illustration is the angular offset between
the Earth’s tidal bulge and the Moon’s position, caused by the Earth’s
rotation. This offset results in a torque that transfers angular
momentum from the Earth’s rotation to the Moon’s orbit. As a
consequence, Earth’s rotation gradually slows while the Moon slowly
recedes from Earth. Much of this behavior can be understood
qualitatively using the tidal tensor for a Keplerian potential: <span
class="math display">\[\mathcal{T}= -\frac{GM}{r^3}\left(\begin{matrix}
                    1-\frac{3x^2}{r^2} &amp; -\frac{3xy}{r^2} &amp;
-\frac{3xz}{r^2} \\
                    -\frac{3yx}{r^2} &amp; 1-\frac{3y^2}{r^2} &amp;
-\frac{3yz}{r^2} \\
                    -\frac{3zx}{r^2} &amp; -\frac{3zy}{r^2} &amp;
1-\frac{3z^2}{r^2}
                \end{matrix}\right),\]</span> which has eigenvalues
<span class="math inline">\(2\frac{GM}{r^3}\)</span>, <span
class="math inline">\(-\frac{GM}{r^3}\)</span>, and <span
class="math inline">\(-\frac{GM}{r^3}\)</span>, with corresponding
eigenvectors: <span class="math display">\[\vec{v}_1,\vec{v}_2,\vec{v}_3
= \dfrac{1}{r}\begin{bmatrix} x \\ y \\ z \end{bmatrix},
\dfrac{1}{r}\begin{bmatrix} -x \\ y \\ 0 \end{bmatrix},
\dfrac{1}{r}\begin{bmatrix} -x \\ 0 \\ z \end{bmatrix}.\]</span></p>
<p>Notably, the first eigenvalue is positive and corresponds to a
stretching deformation along the position vector. The other two are
negative, representing compression in directions perpendicular to the
stretching axis. These directions define a plane orthogonal to the
Earth-Moon line. From this, several tidal effects become evident. For
instance, the Earth’s oceans stretch along the Earth-Moon axis due to
the Moon’s tidal forces. While the Sun also exerts tidal forces on
Earth, their magnitude is weaker due to the <span
class="math inline">\(r^{-3}\)</span> scaling with distance.</p>
<p>When the Moon is either full or new, the Sun and Moon’s tidal forces
act constructively, leading to spring tides. At first and third
quarters, they interfere destructively, causing neap tides.
Additionally, Earth’s tidal influence distorts the Moon from spherical
symmetry into an ellipsoid. The Moon’s most stable orientation is one
where its longest axis aligns with the Earth-Moon line—resulting in
tidal locking.</p>
<p>A more quantitative treatment of these phenomena would require
modeling the Moon’s internal structure and Earth’s ocean dynamics—well
beyond the gravity-only scope of this thesis. However, we can still
explore one instructive effect: how solar tidal forces <em>perturb</em>
the Moon’s orbit away from the idealized two-body Earth-Moon
configuration. Figure <a href="#fig:moon_tidal_simulation"
data-reference-type="ref"
data-reference="fig:moon_tidal_simulation">4</a> shows a toy model
comparing two scenarios. In both, I used initial conditions based on JPL
NASA ephemerides (citation needed) and integrated two sets of equations
of motion.</p>
<p>In the first scenario, the Moon’s motion is governed by the two-body
Earth-Moon problem with a rotating reference frame correction: <span
class="math display">\[\ddot{\vec{r}} = -\frac{GM_\oplus}{r^3}\vec{r} -
\omega_\oplus \times \left(\omega_\oplus \times
\vec{r}_\oplus\right),\]</span> while in the second, we include the
effect of solar tidal forces: <span
class="math display">\[\ddot{\vec{r}} = -\frac{GM_\oplus}{r^3}\vec{r} -
\omega_\oplus \times \left(\omega_\oplus \times \vec{r}_\oplus\right)
-\frac{GM_\odot}{r_\oplus^3}
                \left(\begin{matrix}
                    1-\frac{3x^2}{r_\oplus^2} &amp;
-\frac{3xy}{r_\oplus^2} &amp; -\frac{3xz}{r_\oplus^2} \\
                    -\frac{3yx}{r_\oplus^2} &amp;
1-\frac{3y^2}{r_\oplus^2} &amp; -\frac{3yz}{r_\oplus^2} \\
                    -\frac{3zx}{r_\oplus^2} &amp;
-\frac{3zy}{r_\oplus^2} &amp; 1-\frac{3z^2}{r_\oplus^2}
                \end{matrix}  \right) \cdot \vec{r},\]</span> where
<span class="math inline">\(r_\oplus\)</span> is the Earth’s position
relative to the Sun, <span class="math inline">\(\vec{r}\)</span> is the
Moon’s position relative to Earth, <span
class="math inline">\(M_\odot\)</span> is the mass of the Sun, and <span
class="math inline">\(M_\oplus\)</span> is the mass of the Earth. The
coordinates <span class="math inline">\(x, y, z\)</span> refer to the
components of Earth’s heliocentric position.</p>
  <div class="video-container">
    <video controls style="max-width: 100%;">
      <source src="videos/moon_tidal_simulation.mp4" type="video/mp4">
      Your browser does not support the video tag.
    </video>
  </div>
<figure id="fig:moon_tidal_simulation">
<img src="images/moon_tidal_simulation.png" />
<figcaption>An illustrative experiment demonstrating the effect of the
Sun’s tidal field. The left panels show the tidal field, and the right
panels show two snapshots of the Moon’s orbital trajectory. The green
curve corresponds to the solution of Eq. <strong>XXX</strong>, which
includes the Sun’s tidal effects, while the orange curve corresponds to
the simpler two-body problem that neglects them. The black ellipse
represents the tidal ellipsoid, whose major axis remains aligned with
the Sun’s position vector relative to the Earth. The bottom panel shows
the accumulated phase difference between the two solutions. Neglecting
solar tides causes the predicted Moon orbit to drift ahead of the more
accurate trajectory. With about three to four years, the two body
predicted solution would off by half a moon phase. </figcaption>
</figure>
<h3 class="unnumbered" id="tides-in-the-galaxy">Tides in the Galaxy</h3>
<p>How the tidal field varies throughout the Galaxy by evaluating the
tidal tensor along different orbits and in different mass models. In the
Milky Way, the disk, bulge, and halo each contribute differently to the
tidal forces experienced by a globular cluster. The Miyamoto-Nagai disk
produces strong, rapidly varying tidal fields near the Galactic plane,
leading to phenomena such as disk shocking when clusters cross the disk.
The Martos halo, on the other hand, provides a more slowly varying,
generally weaker tidal field at large Galactocentric radii.</p>
<p>The strength and orientation of the tidal field at a cluster’s
location determine both the rate at which stars are stripped and the
geometry of the resulting stellar streams. For example, clusters on
eccentric or inclined orbits experience time-dependent tidal forces,
with strong compressive shocks during disk crossings and enhanced
stretching near pericenter. The eigenvalues and eigenvectors of the
tidal tensor at each point along the orbit reveal the principal axes of
stretching and compression, which in turn set the directions along which
stars are most likely to escape.</p>
<p>By computing the tidal tensor for the Miyamoto-Nagai disk and Martos
halo potentials, as shown below, we can visualize and quantify these
effects. The following figures illustrate how the tidal field evolves
for representative orbits, highlighting the interplay between the
cluster’s trajectory and the Galactic mass distribution. This analysis
underpins our understanding of stream formation and the morphological
diversity of observed tidal tails.</p>
<p>We can construct the tidal tensor for the Miyamoto-Nagai potential.
First, it is convenient to non-dimensionalize the potential. Below, we
normalize the potential by the total mass and gravitational constant,
<span class="math inline">\(\Phi\prime = \Phi / (GM)\)</span>, and each
distance by the characteristic length of the disk, <span
class="math inline">\(x&#39; = x/a\)</span>, <span
class="math inline">\(b&#39; = b/a\)</span>. For clarity, we omit the
prime notation in what follows. The dimensionless potential then
becomes: <span class="math display">\[\begin{aligned}
                \Phi   &amp;= \frac{1}{D},\\
                D       &amp;= \sqrt{x^2 + y^2 + \beta^2(z)},\\
                \beta(z)   &amp;= 1 + \sqrt{z^2 + b^2}.
            
\end{aligned}\]</span> The dimensionless tidal tensor is then: <span
class="math display">\[\mathcal{T}=-\frac{1}{D^3}\left(\begin{matrix}
                    1-\frac{3x^2}{D^2} &amp; -\frac{3xy}{D^2} &amp;
-\frac{3x\beta \beta&#39;}{D^2} \\
                    \dots &amp; 1-\frac{3y^2}{D^2} &amp; -\frac{3y\beta
\beta&#39;}{D^2} \\
                    \dots &amp; \dots &amp; \beta&#39;^2 + \beta
\beta&#39;&#39; -\frac{3\left(\beta\beta&#39;\right)^2}{D^2}
                \end{matrix}\right).\]</span> We immediately notice
that, due to the cylindrical symmetry, the eigenvectors are not as
simple as in the spherical case. As long as <span
class="math inline">\(\beta&#39;^2 + \beta \beta&#39;&#39;
-\frac{3\left(\beta\beta&#39;\right)^2}{D^2} \neq
1-\frac{3z^2}{D^2}\)</span>, the three eigenvectors are no longer simply
(1) parallel to the position vector and (2) the other two spanning the
plane perpendicular to it. Instead, the exact orientation of all three
eigenvectors depends on the cluster’s position in the galaxy. Note that
if <span class="math inline">\(z=0\)</span>, we recover the stretching
eigenvector being parallel to the position vector, although the
orientations of the eigen vector are fixed as the compression axes are
not the same in magnitude. If, we <span
class="math inline">\(b=0\)</span>, then we recover spherical symmetry
and the compression eigenvalues are the same in magnitude.</p>
  <div class="video-container">
    <video controls style="max-width: 100%;">
      <source src="videos/tidal_deformation_ellipsoid.mp4" type="video/mp4">
      Your browser does not support the video tag.
    </video>
  </div>
<p>Below I have prepared some selected orbits to demonstrate the variety
of shocks and tidal forces than can influence a globular cluster
system.</p>
<figure id="fig:miyamoto_disc_shocks_circular_inclined_orbit">
<img
src="images/miyamoto_disc_shocks_ab_rp_e_i_0.20_4.0_0.01_50.0.png" />
<figcaption>Tidal forces on an inclined yet non-eccentric orbit. Disk
shocks are present, yet there is no tidal stretching from pericenter
passages. <strong>Left</strong>: The three eigenvalues of the tidal
tensor matrix are plotted against time. Both the forces and time are
normalized to the characteristic values of the Miyamoto-Nagai model,
where <span class="math inline">\(a\)</span> is the radial scale length
and <span class="math inline">\(M\)</span> is the total mass of the
system. The red and green curves correspond to the two compressive axes,
while the blue curve shows the magnitude of the stretching axis. The
parameters listed at the top describe the orbit: the ratio of
cylindrical to vertical scale lengths, the apocenter distance, the
eccentricity, and the initial orbital inclination.
<strong>Right</strong>: The orbit is shown in the meridional plane. The
purple stars indicate disk crossing events and correspond to the peaks
in the magnitude of the eigenvalues. </figcaption>
</figure>
<figure id="fig:miyamoto_disc_shocks_circular_inclined_orbit">
<img
src="images/miyamoto_disc_shocks_ab_rp_e_i_0.20_4.0_0.50_0.0.png" />
<figcaption>Evolution of the tidal eigenvectors for an eccentric,
non-inclined orbit, resulting in a compressed meridional plane. Orange
dots mark the pericenter passages. Since the cluster remains confined to
the plane, no disk shocks occur.</figcaption>
</figure>
<figure id="fig:miyamoto_disc_shocks_responant_R_z">
<img
src="images/miyamoto_disc_shocks_ab_rp_e_i_0.20_4.0_0.50_30.0.png" />
<figcaption>An inclined, eccentric orbit in which the frequencies in
both the <span class="math inline">\(R, p_R\)</span> and <span
class="math inline">\(z, p_z\)</span> planes are nearly resonant. The
cluster crosses the disk just before and just after each pericenter
passage. This is the same orbit as the video presented in this section
that is available in the online version.</figcaption>
</figure>
<figure id="fig:miyamoto_disc_shocks_big_apocenter">
<img
src="images/miyamoto_disc_shocks_ab_rp_e_i_0.20_31.6_0.60_50.0.png" />
<figcaption>An eccentric, inclined orbit with a large apocenter. As the
cluster evolves through phase space, disk crossings that occur farther
out happen at steeper angles and in lower-density regions, reducing the
strength of the resulting disk shocks. In contrast, crossings near
pericenter remain strong. Because this orbit has higher energy than the
previous cases, the overall magnitude of the tidal forces is lower.
</figcaption>
</figure>
<figure id="fig:miyamoto_disc_shocks_weak_shocks">
<img
src="images/miyamoto_disc_shocks_ab_rp_e_i_0.88_4.0_0.50_45.0.png" />
<figcaption>Eccentric and inclined orbit in a weak disk. The ratio of
the cylindrical scale length to characteristic height (a/b) is close to
1. The disk crossings still produce significant tidal compression, but
the resulting shocks are broader.</figcaption>
</figure>
<h3 class="unnumbered" id="interesting-case">Interesting case</h3>
<p>The Marto’s halo has this mass distribution:</p>
<p><span class="math display">\[M&#39;_\text{enc}(s) =
\frac{s^\gamma}{1+s^{\gamma-1}}\]</span> The dimensionless tidal tensor
is thus: <span class="math display">\[\mathcal{T&#39;}_{i,j}=
-\frac{M&#39;_\text{enc}(s)}{s^3}\left(\begin{matrix}
                    1-\frac{x^2}{s^2}f(s) &amp; -\frac{xy}{s^2}f(s)
&amp; -\frac{xz}{s^2}f(s) \\
                    -\frac{yx}{s^2}f(s) &amp; 1-\frac{y^2}{s^2}f(s)
&amp; -\frac{yz}{s^2}f(s) \\
                    -\frac{zx}{s^2}f(s) &amp; -\frac{zy}{s^2}f(s) &amp;
1-\frac{z^2}{s^2}f(s)
                \end{matrix}\right)\]</span> where <span
class="math display">\[f(s) = 2-\frac{\gamma-1}{1+s^{\gamma-1}}
                \label{eq:martos_f_s}\]</span></p>
<p>There is an interesting area in the parameter space where the tidal
forces would impede creating stellar streams instead of making them, as
shown in Fig. <a href="#fig:martos_tidal_field_small_r"
data-reference-type="ref"
data-reference="fig:martos_tidal_field_small_r">10</a>.</p>
<p>Taking the Martos tidal tensor in Eq. <a href="#eq:martos_f_s"
data-reference-type="ref"
data-reference="eq:martos_f_s">[eq:martos_f_s]</a>, we can see that for
<span class="math inline">\(\gamma &gt; 3\)</span> and <span
class="math inline">\(s \ll  1\)</span>, then <span
class="math inline">\(f(s)&lt; 0\)</span>. Physically, this would be a
sphere whose density increases with distance. This is not natural, as,
in general, gravity sends the more massive objects towards the center.
However, it’s fun to indulge in this situation to learn some insight
about the flexibility of tidal fields. The consequence of <span
class="math inline">\(f(s)&lt; 0\)</span> is that all terms in the tidal
tensor are negative, which means that the force is compressive
everywhere. Consequently, no stars escape from the cluster.</p>
<p>In Fig. <a href="#fig:martos_tidal_field_small_r"
data-reference-type="ref"
data-reference="fig:martos_tidal_field_small_r">10</a>, I present a
small experiment demonstrating the consequence of such a tidal force on
a globular cluster, which is that no tidal stream forms. Briefly, I
created a plummer sphere of <span
class="math inline">\(10^6\)</span> M<span
class="math inline">\(_\odot\)</span> and half mass radius 20 pc and
evolved it in a Martos halo potential of mass parameter <span
class="math inline">\(10^{12}\)</span> M<span
class="math inline">\(_\odot\)</span> a characteristic radius of <span
class="math inline">\(30\)</span> kpc. Each cluster was placed at the
same initial conditions, a distance of 1/4 the scale radius from the
center of the potential. The initial velocity was made perpendicular to
the position vector with a speed of <span
class="math inline">\((1-e)v_\textrm{c}\)</span>. This is a
pseudo-eccentricity, which was added to have a non-circular orbit to
demonstrate how the trajectories change in the two cases. The top panel
uses a <span class="math inline">\(\gamma\)</span> of 2.02, which is the
same value in the model where the halo was originally presented, and the
value I employ in this thesis. Next, the bottom panel uses <span
class="math inline">\(\gamma\)</span> of 4.5, which corresponds to a
density profile where <span class="math inline">\(\rho(r) \propto
r^{1.5}\)</span>.</p>
<p>To get a feel for the strength of the tidal stretching and
compression, I show a circle and the resulting ellipse after applying
the tidal deformation. I computed the coordinates of the ellipse by
adding <span class="math inline">\(\vec{Ell} = \vec{C} + \frac{1}{2}
t_\textrm{char}^2 \mathcal{T}\cdot \left(\vec{C} -
\vec{r_o}\right)\)</span>. This way, force can be mapped to position
space, and the strengths of the tidal forces can be seen visually. The
characteristic time, <span
class="math inline">\(t_\textrm{char}\)</span>, was set to <span
class="math inline">\(\frac{1}{10} 2\pi r_\textrm{halo} /
v_\textrm{c}\)</span>.</p>
<figure id="fig:martos_tidal_field_small_r">
<p><img src="images/martos_tidal_field_202_10_25.png" alt="image" />
<img src="images/martos_tidal_field_450_10_25.png" alt="image" /></p>
<figcaption>The plots show two low-resolution streams (N = 1000) created
by dissolving a Plummer sphere in the Martos halo potential. The units
are scaled to the halo’s characteristic radius. Gamma is the mass
exponent and is the sole variable between the two simulations. The
panels on the left show the orbit in gray and the stars in black. The
black arrow points towards the center of the potential. The panels on
the right show the tidal field, which is the tidal tensor evaluated at
each position in space. The gray dotted circle is plotted with an
arbitrary radius and is deformed by the tidal field into a black
ellipse.</figcaption>
</figure>
<figure id="fig:martos_tidal_field_big_r">
<p><img src="images/martos_tidal_field_202_10_400.png" alt="image" />
<img src="images/martos_tidal_field_450_10_400.png" alt="image" /></p>
<figcaption>The same experiment as Fig. <a
href="#fig:martos_tidal_field_small_r" data-reference-type="ref"
data-reference="fig:martos_tidal_field_small_r">10</a>, but the cluster
was placed at a larger distance of 4 <span
class="math inline">\(r_\textrm{halo}\)</span>, since we are beyond the
characteristic radius, the tidal fields are the same, despite the
different exponents <span
class="math inline">\(\gamma\)</span>.</figcaption>
</figure>
<p>In the case of Fig. <a href="#fig:martos_tidal_field_big_r"
data-reference-type="ref"
data-reference="fig:martos_tidal_field_big_r">11</a>, the tidal field
returns to the typical situation where one axis is compressive and the
other stretches. Notice how the deformations are similar in magnitude,
while in the case of <span class="math inline">\(\gamma=2.02\)</span>
for the top panel of Fig. <a href="#fig:martos_tidal_field_small_r"
data-reference-type="ref"
data-reference="fig:martos_tidal_field_small_r">10</a>, the compression
is stronger than the expansion. Both of these are different than the
keplerian tidal deformation where the stronger deformation is stretching
and whose axis is parallel to the position vector.</p>
<h2 id="phase-mixing">Phase mixing</h2>
<p><strong>NOTE: I want to add citations and discussions to Vasiliev
Gaia DR3’s look on GCs</strong></p>
<p><em>Phase mixing</em> is a direct consequence of Liouville’s theorem,
which itself follows from the collisionless Boltzmann equation.
Liouville’s theorem states that the infinitesimal volume element in
phase space is preserved under Hamiltonian evolution. In other words, as
a system evolves in time, the phase-space density <span
class="math inline">\(f(\mathbf{q}, \mathbf{p}, t)\)</span> is conserved
along particle trajectories. Since the number of particles is conserved,
and the phase-space volume they occupy does not change, any spatial
spreading must be accompanied by a drop in phase-space density.</p>
<p>This effect causes ensembles of nearby orbits to stretch and fold
through phase space, spreading out and becoming more finely interleaved
over time, even though the total volume is constant. In physical space,
this corresponds to a decrease in local density as the particles become
more dispersed—this is the essence of phase mixing.</p>
<p>We can estimate the characteristic time scale for phase mixing by
considering how long it takes for orbits with slightly different
energies to drift apart in phase. For a Keplerian orbit, the orbital
period is given by:</p>
<p><span class="math display">\[T^2 = \frac{4\pi^2
a^3}{GM},\]</span></p>
<p>which implies that the period depends on the semi-major axis and thus
on the orbital energy. In general, most orbits are not closed, so rather
than returning to the exact same phase-space point, particles precess
and fill out invariant tori over time. It is therefore useful to define
a characteristic orbital timescale in terms of energy. From dimensional
analysis, we argue that the characteristic time for a body to complete a
phase space cycle is:</p>
<p><span class="math display">\[T_\mathrm{char} = C
\frac{GM}{E^{3/2}},\]</span></p>
<p>where <span class="math inline">\(C\)</span> is a constant and <span
class="math inline">\(E\)</span> is the specific orbital energy.</p>
<p>Consider now two nearby particles with energies <span
class="math inline">\(E - \Delta E\)</span> and <span
class="math inline">\(E + \Delta E\)</span>. Their orbital frequencies
differ by:</p>
<p><span class="math display">\[\Delta f = \frac{1}{T( E - \Delta E)} -
\frac{1}{T(E + \Delta E)}.\]</span></p>
<p>The time required for the faster particle to lap the slower one in
phase is the <em>phase mixing time</em>, which is the inverse of the
difference <span class="math inline">\(2\pi / \Delta f\)</span> and is
given by:</p>
<p><span class="math display">\[T_\mathrm{mix} = \frac{2\pi}{\Delta f} =
\frac{2\pi T_1 T_2}{T_2 - T_1}.\]</span></p>
<p>For small energy differences <span class="math inline">\(\Delta E
&lt;&lt; E\)</span>, we can expand the period in a Taylor series to
first order. This leads to:</p>
<p><span class="math display">\[T_\mathrm{mix} \approx T_\mathrm{char}
\cdot 2\pi \left( \frac{E}{3 \Delta E} \right),
            \label{EQ:phase_mixing}\]</span> Thus, the phase mixing time
grows inversely with the relative energy spread in the population.</p>
<h3 id="orbital-drift">Orbital drift</h3>
<p>The first manifestation of phase mixing is the growth of uncertainty
in orbital solutions for globular clusters over time. This originates
from the initial spread in orbital energies caused by observational
uncertainties. In Fig.<a
href="#fig:phase_mixing_palomar_5_orbital_solutions"
data-reference-type="ref"
data-reference="fig:phase_mixing_palomar_5_orbital_solutions">12</a>, I
present an example based on Palomar 5, for which I compute 50 orbital
solutions in our potential model. These initial conditions are sampled
according to the uncertainties reported in the Baumgardt catalog. The
figure shows that while the orbital solutions remain broadly similar,
the lower-energy orbits progress through phase space more rapidly. In
the bottom panel, the rightmost side includes overplotted dots
indicating the final <span class="math inline">\((t, z)\)</span>
coordinates of each solution, illustrating that they span nearly the
full range of <span class="math inline">\(z\)</span> values allowed by
the initial conditions. In essence, once the integration time exceeds
the phase-mixing timescale, any individual solution becomes speculative:
the system could plausibly occupy any location in phase space permitted
by the initial conditions.</p>
<figure id="fig:phase_mixing_palomar_5_orbital_solutions">
<img src="images/phase_mixing_palomar_5_orbital_solutions.png" />
<figcaption>Phase mixing of Palomar 5’s orbital solutions in the
<code>Pouliasis2017pii</code> potential. We sample 50 different initial
conditions based on the observational uncertainties in distance, radial
velocity, and proper motions. Each orbital solution is color-coded by
its initial total orbital energy <span class="math inline">\(E\)</span>.
The top six panels show snapshots of the positions in the <span
class="math inline">\(xy\)</span>-plane of the orbital solutions at
different times. The bottom panel shows the evolution of the <span
class="math inline">\(z\)</span> coordinate as a function of time. Black
vertical bars mark the timestamps corresponding to the snapshots in the
top panels, which are labeled with matching alphabetical
identifiers.</figcaption>
</figure>
<p>By inspecting Eq.<a href="#EQ:phase_mixing" data-reference-type="ref"
data-reference="EQ:phase_mixing">[EQ:phase_mixing]</a>, we note that if
the phase-mixing time is normalized by the characteristic orbital time,
the resulting dimensionless mixing time is inversely proportional to the
uncertainty in orbital energy. This relationship is general and holds
for all orbits, regardless of their periods. However, it is still
illustrative to examine this behavior in the context of the globular
cluster catalog. In Fig.<a
href="#fig:phase_mixing_orbital_errors_sample" data-reference-type="ref"
data-reference="fig:phase_mixing_orbital_errors_sample">13</a>, I
present the phase-mixing times for all Galactic globular clusters, based
on current uncertainties from the Gaia DR3 catalog. The top panel shows
the distribution for all 165 clusters. The bottom panels highlight the
mixing behavior in cylindrical radius for a selection of statistically
representative clusters: Gran 1, which has the shortest mixing time;
Gran 5, the median case; NGC 6752, whose mixing time is closest to the
mean; and NGC 2419, which has the longest mixing time.</p>
<p>It is important to emphasize that these estimates are highly
model-dependent. In some cases, the models predict phase-mixing
timescales exceeding the age of the Universe. Unsurprisingly, the
phase-mixing time correlates with the orbital period, which itself is
related to the cluster’s distance from the Galactic center. At large
Galactocentric distances, the gravitational potential of the Milky Way
becomes increasingly uncertain, as observational constraints on the
Galactic mass distribution are weaker. Therefore, these extreme mixing
times should not be interpreted as implying that we can predict the
phase-space location of certain clusters with high confidence over
cosmological timescales.</p>
<figure id="fig:phase_mixing_orbital_errors_sample">
<p><img src="images/phase_mixing_time_histogram_MWGCS.png"
alt="image" /> <img src="images/phase_mixing_orbital_errors_sample.png"
alt="image" /></p>
<figcaption>The top panel shows the distribution of phase-mixing times
for globular clusters, computed using Eq. <a href="#EQ:phase_mixing"
data-reference-type="ref"
data-reference="EQ:phase_mixing">[EQ:phase_mixing]</a>. The following
four rows illustrate the phase-mixing behavior for four selected
clusters over the time range considered in this experiment. Orbital
solutions are color-coded by their normalized deviation from the mean
orbital energy.</figcaption>
</figure>
<p>It’s also interesting to note how the uncertainties in the orbital
energy relates to the uncertainties in each observable. In Fig. <a
href="#fig:energy_sensitivity_analysis_MWGCS_to_distance_RV_mu"
data-reference-type="ref"
data-reference="fig:energy_sensitivity_analysis_MWGCS_to_distance_RV_mu">14</a>,
I perform this quick calulation. The uncertainties are measured in
Galactic coordinates the ICRS coordinate system. This is a direct
transformation to Galactic coordinates and thus can be expressed
analytically.</p>
<figure id="fig:energy_sensitivity_analysis_MWGCS_to_distance_RV_mu">
<img src="images/energy_sensitivity_analysis_MWGCS_to_errors.png" />
<figcaption>An analysis on the spread in orbital energies of the
globular cluster population for each of its reported uncertainties. Each
panel finds the STD in the Hamiltonain given the uncertainties in the
specific variable. So the top left allows the distances to vary but
holds the proper motions and radial velocities constant. It is plotted
against the distance. The clusters are color-coated by their mean
energies.</figcaption>
</figure>
<h3 id="mixing-of-tidal-debris">Mixing of tidal debris</h3>
<p>At first glance, Fig. <a
href="#fig:phase_mixing_palomar_5_orbital_solutions"
data-reference-type="ref"
data-reference="fig:phase_mixing_palomar_5_orbital_solutions">12</a>
might give the impression that we are looking at snapshots of a single
stellar stream at different times. In reality, the figure shows
different orbital solutions. This visual similarity underscores that
both phenomena—stellar streams and diverging orbital solutions—are
manifestations of phase mixing. However, there is a crucial distinction:
phase mixing of tidal debris is a physical process involving actual
particles with slightly different initial conditions, whereas diverging
orbital solutions represent the increasing uncertainty in predicted
trajectories over time.</p>
<p>Still, it is useful to use phase mixing as an analogy, though the
physical assumptions differ. In particular, the analogy breaks down
because globular clusters are self-gravitating systems: stars interact
gravitationally and remain bound for a significant time. This
self-gravity slows down the mixing process. The time it takes for a
globular cluster to dissolve and distribute its stars uniformly in phase
space is typically longer than the idealized mixing time given by Eq. <a
href="#EQ:phase_mixing" data-reference-type="ref"
data-reference="EQ:phase_mixing">[EQ:phase_mixing]</a>.</p>
<p>Let us briefly illustrate this with a conceptual calculation:</p>
<ul>
<li><p><strong>Case 1</strong>: Particles drift apart under phase mixing
with no mutual gravitational influence.</p></li>
<li><p><strong>Case 2</strong>: Particles are bound by a central
potential, representing the cluster’s self-gravity.</p></li>
</ul>
<p>From this thought experiment, we see that phase mixing proceeds more
slowly when self-gravity is included. Nevertheless, phase mixing still
governs the long-term behavior of tidally escaped stars.</p>
<p>Importantly, we need not consider all particles within the cluster to
study phase mixing. For clusters with short orbital mixing times
compared to the simulation duration, stars that escape during the
simulation can redistribute throughout the available phase space. While
the resulting debris will not be uniformly distributed—an overdensity
will remain at the cluster location—the tidal debris will broadly fill
the phase space accessible to it. This point is crucial for the results
discussed in Chapter 4.</p>
<h2 id="collisions">Collisions</h2>
<p>Collisions are essential in this thesis for two reasons. Firstly, one
of the main research questions is how the passage of a subhalo perturbs
a stellar stream. This interaction can be treated as a gravitational
collision.</p>
<p>In general, we are interested in how much the momentum of a particle
changes before and after the encounter. We can simplify the scenario by
assuming that the target particle is initially at rest, and that the
perturber (the subhalo) flies by with a minimum distance of approach
<span class="math inline">\(b\)</span>—the <em>impact
parameter</em>.</p>
<p>Since both objects exert gravitational forces on each other, the
target will gain energy and begin to move, while the perturber will be
slightly deflected and slow down. However, to simplify the calculation,
we assume the perturber is unperturbed by the target—i.e., it moves on a
straight-line trajectory with constant speed <span
class="math inline">\(v\)</span>.</p>
<p>In this approximation, we compute the momentum change of the target
by integrating the gravitational force over time. Gravity is always
attractive: the perturber pulls the target particle to the left before
the closest approach and to the right afterward. If the trajectory is
symmetric and unperturbed, the components of the force parallel to the
motion cancel out. Thus, the net momentum transfer is perpendicular to
the motion of the perturber.</p>
<p>Assume the perturber moves along the <span
class="math inline">\(x\)</span>-axis with impact parameter <span
class="math inline">\(b\)</span>, and the target lies at the origin.
Then the net force acts in the <span class="math inline">\(+y\)</span>
direction. The gravitational force scales as <span
class="math inline">\(1/d^2\)</span>, so for distances <span
class="math inline">\(d \gg b\)</span>, the force becomes negligible. We
can then approximate the force as roughly constant over a short time
interval during the closest approach.</p>
<p>We estimate the duration of the interaction as the time it takes the
perturber to travel a distance <span class="math inline">\(2b\)</span>
(from <span class="math inline">\(x = -b\)</span> to <span
class="math inline">\(x = +b\)</span>), giving <span
class="math inline">\(\Delta t = 2b/v\)</span>. Assuming a constant
perpendicular force <span class="math inline">\(F_\perp \approx
GMm/b^2\)</span>, the change in momentum is:</p>
<p><span class="math display">\[\begin{aligned}
        m\,\delta v_y &amp;=&amp; \int F_\perp \, dt \\
                    &amp;\approx&amp; F_\perp \cdot \Delta t \\
                    &amp;=&amp; \frac{GMm}{b^2} \cdot \frac{2b}{v}
        
\end{aligned}\]</span></p>
<p>Dividing both sides by <span class="math inline">\(m\)</span>, the
change in velocity is: <span class="math display">\[\delta v_y =
\frac{2GM}{b v}\]</span></p>
<p>It is interesting to note that this result is inversely proportional
to the velocity of the perturber. This behavior contrasts with contact
collisions, where a higher speed typically results in a greater momentum
transfer. In gravitational encounters, a faster flyby leads to a shorter
interaction time and thus less momentum exchange.</p>
<h3 id="gapology">Gapology</h3>
<p>Gaps in stellar streams are underdensities that appear after
encounters with dark matter subhalos or globular clusters. These can be
understood as resulting from collisions. However, modeling the
interaction as one point mass hitting another is too simplistic. What
happens when an extended object, like a subhalo, interacts with a
continuous stellar stream? Before delving into the technical details, it
is worth clarifying a misconception–one that I myself held when first
approaching this problem. Encounters between stellar streams and
perturbers are not violent collisions in which stars are physically
ejected or stripped from the stream. Rather, the perturber imparts a
small, localized change in velocity to nearby stars, subtly altering
their orbital periods. Over time, these tiny shifts accumulate, causing
stars to drift apart and gradually sculpting a visible underdensity: the
gap.</p>
<p>To address this, we turn to the work of <span class="citation"
data-cites="2015MNRAS.450.1136E">Erkal and Belokurov (2015)</span>, who
studied a simplified model: a stream with uniform density on a circular
orbit. This idealized setup allows for an analytical treatment of the
gap’s formation and evolution. A gap can be characterized by two main
quantities: its angular width, <span class="math inline">\(\Delta
\theta\)</span>, and the density contrast, <span
class="math inline">\(\rho_{\mathrm{peak}}/\rho_0\)</span>, between the
overdensities at the gap’s edges and the central underdensity.</p>
<p>To understand how these evolve, the authors derived a
parameterization of the change in velocity <span
class="math inline">\(\Delta \vec{v}\)</span> for stars along the stream
after a perturbation. This vector function depends on the position <span
class="math inline">\(y\)</span> along the stream relative to the impact
point and on several parameters describing the perturber and the impact
geometry: <span class="math display">\[\Delta \vec{v} = f(y \,|\, M,
r_s, b, w_\parallel, w_\perp, \alpha),\]</span> where <span
class="math inline">\(M\)</span> is the impactor’s mass, <span
class="math inline">\(r_s\)</span> its scale radius, <span
class="math inline">\(b\)</span> the impact parameter, <span
class="math inline">\(w_\parallel\)</span> and <span
class="math inline">\(w_\perp\)</span> the components of its velocity
parallel and perpendicular to the stream, and <span
class="math inline">\(\alpha\)</span> the angle between the impactor’s
trajectory and the <span class="math inline">\((x,z)\)</span>-axes.</p>
<p>To set up the problem, a coordinate system is defined where the
stream lies along the <span class="math inline">\(y\)</span>-axis, and
the impact occurs at <span class="math inline">\(y=0\)</span>. Because
the stream has spatial extent, the impactor’s motion must be decomposed
into parallel and perpendicular components with respect to the stream.
Unlike the simpler point-mass approximation, here <span
class="math inline">\(\Delta \vec{v}\)</span> generally has nonzero
components in all directions. In particular, <span
class="math inline">\(\Delta v_y\)</span> alters the speed along the
stream, while <span class="math inline">\(\Delta v_x\)</span> and <span
class="math inline">\(\Delta v_z\)</span> displace stars out of the
stream’s plane. <span class="math inline">\(\Delta v_x\)</span> or <span
class="math inline">\(\Delta v_z\)</span> can be zero if the trajectory
of the impactor is parallel to the <span
class="math inline">\(x\)</span> axis or <span
class="math inline">\(z\)</span> axis, respectively.</p>
<p>The expression for <span class="math inline">\(\Delta v_y\)</span>
is: <span class="math display">\[\Delta v_y\left(y\,|\, M, r_s, b,
w_\parallel, w_\perp\right) = - \frac{2GM w_\perp^2 y}{w\left[\left(b^2
+ r_s^2\right)w^2 + w_\perp^2 y^2\right]},\]</span> which is an odd
function of <span class="math inline">\(y\)</span>, as expected for a
gravitationally attractive force: stars ahead of the impact point (<span
class="math inline">\(y&gt;0\)</span>) are slowed down, while those
behind (<span class="math inline">\(y&lt;0\)</span>) are sped up.</p>
<figure id="fig:erkal_2015_fig_3">
<img src="images/erkal_et_al_2015_fig_3.png" />
<figcaption>The change in velocity, <span class="math inline">\(\Delta
v_y\)</span>, of stars along the stream after an impact. The stream lies
along the <span class="math inline">\(y\)</span>-axis, with the point of
impact at the origin. Key features are labeled: the maximum value of
<span class="math inline">\(\Delta v_y\)</span>, its location, and the
full width at half maximum. Taken from Fig. 3 of <span class="citation"
data-cites="2015MNRAS.450.1136E">Erkal and Belokurov
(2015)</span>.</figcaption>
</figure>
<p>Several assumptions underlie this formulation. First, the stream is
approximated as a straight line, which requires the size of the impacted
region to be much smaller than the orbital circumference. Second, the
velocities of both the stream and the perturber are assumed constant,
implying that the duration of the impact is much shorter than the
system’s orbital period. These assumptions also imply that the impactor
must pass close to the stream and be compact relative to the stream’s
orbital radius.</p>
<p>The authors then developed the time evolution of the stream’s density
following the impact. To study these, the authors employed three
complementary approaches:</p>
<ol>
<li><p>A numerical solution of a transcendental equation governing <span
class="math inline">\(\Delta \theta(t)\)</span>;</p></li>
<li><p>A fully analytic solution for a low-order analytical
approximation valid when the gap opening <span
class="math inline">\(\Delta \theta\)</span> is still small;</p></li>
<li><p>An <span class="math inline">\(N\)</span>-body simulation of the
full system.</p></li>
</ol>
<p>Together, these revealed three distinct phases of gap evolution:</p>
<ol>
<li><p><strong>Compression phase</strong> – Shortly after the impact,
stars on opposite sides swap places, briefly compressing the stream
until the right and left sides overtake one another.</p></li>
<li><p><strong>Linear growth phase</strong> – The gap grows roughly
linearly in time, as stars move apart under their velocity
differences.</p></li>
<li><p><strong>Caustic phase</strong> – Eventually, stars bunch up at
different locations at the edges of the gap, creating sharp overdensity
features (“caustics”). Additionally, the gap’s growth to is slowed to a
sublinear rate, scaling roughly as <span class="math inline">\(\propto
\sqrt{t}\)</span>.</p></li>
</ol>
<p>The author’s make an important realization. Even in a scenario where
the galactic potential and the stream’s orbit are known, with just the
gap’s density profile there are still seven parameters that describe
it’s shape: <span
class="math inline">\(M,r_s,b,w_\perp,w_\parallel,\alpha,t\)</span>. The
authors state that the gap’s profile provide two more piece of
information and with a constraint on the perturber’s density, we would
still be left with four degrees of freedom. The problem is thus
underdetermined and it is thus impossible to uniquely determine the
properties of the perturber. A large statistical sample of gaps would be
required to constrain a population of dark matter subhalos. With the
ever increasing data quality, perhaps this could be possible
someday.</p>
<p>While powerful, the authors describe how the limiting assumptions
impact the interpretations of this work. First, the framework is limited
to circular orbits which poses a significant constraint especially for
globular clusters which often have inclined and eccentric trajectories.
Indeed, as they discussed in their work, streams do not have uniform
densities. Stars that populate the streams come from tidally disrupting
stellar systems. As they leave the cluster and enter the stream, they
come with a range of energies and and angular momenta that in essence
eliminate any casutic features.</p>
<p><span class="citation" data-cites="2016MNRAS.457.3817S">Sanders,
Bovy, and Erkal (2016)</span> expanded on this foundation and provided a
truly exchaustive and comprehensive exploration of stream-subhalo
interactions. Their primary methodological innovation was the
development of a framework for modeling the impact of dark matter
subhaloes on cold, thin streams in angle-frequency space. This space
significantly simplifies stream dynamics, allowing for the rapid
generation of general stream models and proving ideal for incorporating
velocity perturbations from subhaloes. They developed methods to compute
velocity, angle, and frequency kicks for general subhaloes and impact
geometries, then translated these into angle and frequency
perturbations. This framework allowed for an extensive range of
experiments:</p>
<ul>
<li><p><strong>Various perturber models</strong>: <span class="citation"
data-cites="2016MNRAS.457.3817S">Sanders, Bovy, and Erkal (2016)</span>
compared velocity kicks produced by various astrophysically relevant
subhalo profiles, including Plummer, Hernquist, truncated
Navarro-Frenk-White (NFW), and non-truncated NFW profiles. They found
that while there are differences in kick amplitudes depending on the
profile, the absolute differences between these methods were generally
small, especially for lower-mass impacts, suggesting the simpler "curved
approximation" (which accounts for stream curvature but assumes fixed
relative velocity during flyby) is often sufficient</p></li>
<li><p><strong>Different Orbits for the Progenitor</strong>: key
advancement was the focus on streams formed from progenitors on
eccentric orbits. This directly addressed a limitation of <span
class="citation" data-cites="2015MNRAS.450.1136E">Erkal and Belokurov
(2015)</span>, which primarily restricted its analysis to streams on
circular orbits. The angle-frequency space formalism is particularly
well-suited for modeling these more complex, realistic eccentric stream
dynamics.</p></li>
<li><p><strong>Different Impact Points</strong>: The study thoroughly
investigated how the stream changes depending on where along the stream
the impact occurs. They simulated impacts both close to the progenitor
(where particles are more mixed in energy) and further downstream (where
particles are better ordered by energy), finding that the growth rate of
the gap depends on the impact location.</p></li>
</ul>
<p>Drawing from these comprehensive investigations, <span
class="citation" data-cites="2016MNRAS.457.3817S">Sanders, Bovy, and
Erkal (2016)</span> reached several essential conclusions and insights
into “gapology”:</p>
<ul>
<li><p><strong>Dominance of Frequency Kicks</strong>: They found that
angle perturbations from a flyby are generally only significant on short
timescales (less than a radial period). At later times, the frequency
perturbations become much more important, controlling the future
structure of the gap. These frequency perturbations are simply related
to the velocity perturbations (specifically, the change in energy, <span
class="math inline">\(v \cdot \delta v_g\)</span>) in scale-free
potentials.</p></li>
<li><p><strong>Gap Growth and Density Plateau</strong>: While <span
class="citation" data-cites="2015MNRAS.450.1136E">Erkal and Belokurov
(2015)</span> predicted gap growth slowing to a <span
class="math inline">\(t^{1/2}\)</span> rate in the caustic phase and the
central density decreasing as <span
class="math inline">\(t^{-1}\)</span>, <span class="citation"
data-cites="2016MNRAS.457.3817S">Sanders, Bovy, and Erkal (2016)</span>
observed that the minimum gap density eventually plateaus in time. This
plateau value decreases with increasing subhalo mass and is attributed
to the stream’s non-zero velocity dispersion, allowing upstream material
to fill in the gap, and the non-uniform unperturbed stream
density.</p></li>
<li><p><strong>Impact Location Affects Growth Rate</strong>: They
discovered that gaps formed far downstream grow more rapidly than those
closer to the progenitor. This is because stream members far from the
progenitor are more "ordered" by energy, leading to an already growing
underlying stream structure that enhances gap formation.</p></li>
</ul>
<p>For many of the experiments, the authors cross validate the
semi-analytic formalism against NBody simulations and present truly
robust results. Below, I want to show how one can understand a 1D
stream.</p>
<p>To first order, a stellar stream can be modeled as a
<em>collisionless</em>, non-accelerating ensemble of stars — i.e., a
one-dimensional <em>streaming</em> solution to the collisionless
Boltzmann equation. In this case, the equation simplifies to:</p>
<p><span class="math display">\[\frac{\partial f}{\partial t} + v
\frac{\partial f}{\partial x} = 0,\]</span></p>
<p>where <span class="math inline">\(f(x,v,t)\)</span> is the
phase-space distribution function. We assume the initial condition <span
class="math inline">\(f(x,v,t=0) = 0\)</span>, and a boundary condition
of a constant source at <span class="math inline">\(x=0\)</span>:</p>
<p><span class="math display">\[f(0,v,t) = g(v \,|\, v_0, \sigma_v) =
\mathcal{N}(v \,|\, v_0, \sigma_v),\]</span></p>
<p>i.e., a Gaussian ejection velocity distribution centered at <span
class="math inline">\(v_0\)</span> with dispersion <span
class="math inline">\(\sigma_v\)</span>. The total flux amplitude is
arbitrary here.</p>
<p>Using the method of characteristics, we find that <span
class="math inline">\(f\)</span> is constant along lines of the form
<span class="math inline">\(x - vt = \text{const}\)</span>. This means
we are solving a PDE in the <span class="math inline">\((x,t)\)</span>
plane for fixed values of <span class="math inline">\(v\)</span>. The
initial condition implies that <span class="math inline">\(f=0\)</span>
in regions not yet reached by any particles — that is, wherever <span
class="math inline">\(x/t &gt; v\)</span>. Thus, the solution is:</p>
<p><span class="math display">\[f(x,v,t) =
                \begin{cases}
                    \mathcal{N}(v \,|\, v_0, \sigma_v) &amp; \text{if }
v &gt; \frac{x}{t}, \\
                    0 &amp; \text{otherwise}.
                \end{cases}
                \label{eq:one_dimensional_collisionless_streaming}\]</span></p>
<p>We can now compute the moments of this distribution. The density at
each position is given by:</p>
<p><span class="math display">\[\rho(x,t) = \int_{x/t}^{\infty} f(x,v,t)
\, dv = \frac{1}{2} \, \mathrm{erfc}\left( \frac{x/t -
v_0}{\sqrt{2}\sigma_v} \right),\]</span></p>
<p>i.e., the integral of a truncated Gaussian. Similarly, the <em>mean
velocity</em> and <em>velocity dispersion</em> at fixed <span
class="math inline">\((x,t)\)</span> are computed from the conditional
distribution <span class="math inline">\(f(v|x,t) =
f(x,v,t)/\rho(x,t)\)</span>, via:</p>
<p><span class="math display">\[\begin{aligned}
                \langle v \rangle(x,t) &amp;= \frac{1}{\rho(x,t)}
\int_{x/t}^\infty v f(x,v,t) \, dv, \\
                \langle v^2 \rangle(x,t) &amp;= \frac{1}{\rho(x,t)}
\int_{x/t}^\infty v^2 f(x,v,t) \, dv, \\
                \sigma_v^2(x,t) &amp;= \langle v^2 \rangle(x,t) -
\langle v \rangle(x,t)^2.
            
\end{aligned}\]</span></p>
<p>Each of these integrals can be expressed analytically in terms of the
error function and exponential functions, since they are the moments of
a truncated Gaussian.</p>
<p>In Fig. <a href="#fig:collisionless_1D_stream"
data-reference-type="ref"
data-reference="fig:collisionless_1D_stream">16</a>, I show a plot of
the <em>density</em>, <em>mean velocity</em>, and <em>velocity
dispersion</em> as a function of position at a given time. The figure
illustrates how the leading edge of the stream (larger <span
class="math inline">\(x\)</span>) contains only the fastest particles
and thus has a lower density and higher average velocity. Conversely,
the trailing regions have a broader mix of velocities and higher local
dispersion.</p>
<figure id="fig:collisionless_1D_stream">
<img src="images/collisionless_1D_stream.png" />
<figcaption>A snapshot at a fixed time of selected moments of the
distribution function describing one-dimensional collisionless
streaming, used here as an approximation for a stellar stream, as given
by Eq. <a href="#eq:one_dimensional_collisionless_streaming"
data-reference-type="ref"
data-reference="eq:one_dimensional_collisionless_streaming">[eq:one_dimensional_collisionless_streaming]</a>.
Particles are continuously injected at the origin with velocities drawn
from a Gaussian distribution with mean <span
class="math inline">\(v_0\)</span> and dispersion <span
class="math inline">\(\sigma_v\)</span>. Shown are the particle density,
local mean velocity, and local velocity dispersion, all normalized.
</figcaption>
</figure>
<p><em>Note:</em> I would love to explore this more rigorously in the
context of time-dependent or eccentric mass loss, where the source term
becomes periodic. I did begin studying such a model using a
time-dependent Gaussian source, but at some point the “simple approach”
becomes as complex as full numerical simulations.</p>
<h1 id="the-ignored-physics">The Ignored Physics</h1>
<p>In essence, we want to quantify the number of interactions a star
will have as it travels through the galaxy. There is a quick way to do
this, which is to assume that the cross-sectional surface density of the
star as it passes through the galactic medium is constant. Even after
performing some of these assumptions, a useful relationship is found,
which is that the relaxation time is  N/log(n) t_cross</p>
<p>The classic case of a galaxy shows that in a spherical galaxy, this
time is approximately 10^4 times the age of the universe. For globular
clusters, this time is on the order of 1 Gyr, which is smaller than
their lifetime.</p>
<p>This means that the effect of collisions is quite crucial for
discussing their evolution.</p>
<p>There are many important works dedicated to this problem, and several
aspects are well understood. Heggie and Hut do a great job of explaining
some of these things. Some of the many effects that are lost by ignoring
this are mass segregation and evaporation.</p>
<h2 id="collisional-dynamics">Collisional dynamics</h2>
<p>Globular clusters are undoubteled collisional systems. The same
computating using the columb law, to compute how long it takes for a
given particles to change it’s momentum on same order of magnitude as
it’s initial momentum is much less than the age of a given globular
cluster. This computation is what justified us for using the fluid limit
for galactic dynamics, and it is the same computation that instructs us
that we are incorrect for globular clusters. <span class="citation"
data-cites="2023LRCA....9....3S">Spurzem and Kamlah (2023)</span>
published a review discussing <em>Computational methods for collisional
stellar systems</em>, and entitled one of their sections <em>Nbody the
growth of an industry</em>.</p>
<ul>
<li><p>not nbody</p></li>
<li><p>no mass segregation</p></li>
<li><p>no three body encounters</p></li>
<li><p>no soft or hard binaries</p></li>
<li><p>show some results from Corespray</p></li>
</ul>
<h2 id="stellar-evolution">Stellar evolution</h2>
<ul>
<li><p>They’re all point masses</p></li>
<li><p>No salpeter’s</p></li>
<li><p>No strong initial mass loss</p></li>
<li><p>No accurate model for the colors</p></li>
<li><p>No multiple stellar populations</p></li>
</ul>
<h2 id="time-evolution">Time evolution</h2>
<p>In someways, we take time evolution into account, and in someways, we
ignore and this has already been covered in the previous sections. i.e.,
the orbit of the star-particles depend on the position of the host
globular cluster, which I do not solve for simoltaneously but instead
opt to load it into the computation, as shown in Section <a
href="#subsec:myEquationsOfMotion" data-reference-type="ref"
data-reference="subsec:myEquationsOfMotion">1.1</a>. Also, things like
mass segregation and stellar evolution are time-dependent which is
completely ignored in my simulations.</p>
<div id="refs" class="references csl-bib-body hanging-indent"
data-entry-spacing="0" role="list">
<div id="ref-2015MNRAS.450.1136E" class="csl-entry" role="listitem">
Erkal, Denis, and Vasily Belokurov. 2015. <span>“<span
class="nocase">Forensics of subhalo-stream encounters: the three phases
of gap growth</span>”</span> 450 (1): 1136–49. <a
href="https://doi.org/10.1093/mnras/stv655">https://doi.org/10.1093/mnras/stv655</a>.
</div>
<div id="ref-koon2000dynamical" class="csl-entry" role="listitem">
Koon, Wang Sang, Martin W Lo, Jerrold E Marsden, and Shane D Ross. 2000.
<span>“Dynamical Systems, the Three-Body Problem and Space Mission
Design.”</span> In <em>Equadiff 99: (In 2 Volumes)</em>, 1167–81. World
Scientific.
</div>
<div id="ref-2016MNRAS.457.3817S" class="csl-entry" role="listitem">
Sanders, Jason L., Jo Bovy, and Denis Erkal. 2016. <span>“<span
class="nocase">Dynamics of stream-subhalo interactions</span>”</span>
457 (4): 3817–35. <a
href="https://doi.org/10.1093/mnras/stw232">https://doi.org/10.1093/mnras/stw232</a>.
</div>
<div id="ref-2023LRCA....9....3S" class="csl-entry" role="listitem">
Spurzem, Rainer, and Albrecht Kamlah. 2023. <span>“<span
class="nocase">Computational methods for collisional stellar
systems</span>.”</span> <em>Living Reviews in Computational
Astrophysics</em> 9 (1): 3. <a
href="https://doi.org/10.1007/s41115-023-00018-w">https://doi.org/10.1007/s41115-023-00018-w</a>.
</div>
</div>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>The term "integral of motion" is often used
interchangeably with "constant of motion," but strictly speaking, the
latter is preferable since it refers to a quantity that remains constant
throughout the orbital evolution, not to an integral in the mathematical
sense of the word (area under a curve).<a href="#fnref1"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</body>
</html>
